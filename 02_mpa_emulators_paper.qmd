---
title: "Predicted Effects of Marine Protected Areas on Conservation and Catches are Highly Sensitive to Model Structure"
author:
  - name: Daniel Ovando
    affiliation:
      - name: Inter-American Tropical Tuna Commission
        department: Ecosystem & Bycatch Group
        id: 1
        address: 8901 La Jolla Shores Drive
        city: La Jolla
        state: CA
        postal-code: 92037
    email: dovando@iattc.org
    attributes:
      equal-contributor: true
      corresponding: true
format:
  html: 
    toc: true
  pdf:
    toc: true
  nature-pdf:
    keep-tex: true
    classoption: [lineno, referee]
    toc: true
    equal-margins: true
bibliography: references.bib
abstract: |
 Use of Marine Protected Areas (MPAs) is expanding around the world. While MPAs can have a wide variety of objectives, scientific guidance on how to design MPAs to achieve objectives is generally based on simulation modeling. While certain questions require specific types of models, in other cases many different models may all provide an answer of some kind to a question, such as the predicted change in population biomass and fisheries catches resulting from implementation of an MPA. In these cases, the spatial and temporal scale of MPAs can prevent us from determining which model is most parsimoneous empirically, and as such the choice of model complexity can be somewhat *ad hoc*. In this paper we compare the effects of MPAs on catch and biomass predicted by a spatially explicit age-structured multi-species and multi-fleet (*High-definition*) model to the predictions generated by a two-patch surplus production (*Low-definition*) model fit to emulate the *High-definition* model. We found that while there are some areas of agreement, in many cases the predictions of the two models were markedly different, with the *Low-definition* model frequently predicting substantially higher biomass and catch benefits from MPAs than the *High-definition* model, and in many cases incorrectly estimating the direction (positive or negative) of the MPA effects. Our results show that care should be taken in selecting and interpreting the results of MPA simultion models, and that research is needed to understand what models are best suited to what policy recommendations when multiple viable options exist. 
keywords: [MPA, Simulation Modeling, Model Selection, Conservation Planning, Food Security]
execute: 
  echo: false
  warning: false
---

```{r}
#|label: setup
#|include: false

foos <- list.files(here::here("R"))

purrr::walk(foos, ~ source(here::here("R", .x)))

prep_run(run_name = "emulators_v1.0") # loads packages and creates and returns some global variables for the analysis

# clean up figures generated in the report to ensure that all figures come from a fresh state
paper_figs <- file.path(fig_dir,list.files(fig_dir)[list.files(fig_dir) |> str_detect("fig_")])

unlink(paper_figs)

difficulties <- c("simple","medium","complex")

min_depletion <- 0.00001

tune_grids <- TRUE
```

```{r}
#| label: load-results
#| include: false


results <- list.files(results_dir)

results <- results[str_detect(results,"(processed_sims.rds$)|(emulated_experiment_results.rds)|(placement_experiments.rds)|(state_experiments.rds)")]



purrr::walk(results, ~ assign(str_remove_all(.x,"\\.rds$"), read_rds(here(results_dir,.x)), envir = .GlobalEnv))

critter_namer <- function(x){
  
  y <- forcats::fct_recode(x,shark = "carcharhinus amblyrhynchos",grouper = "epinephelus fuscoguttatus",snapper = "lutjanus malabaricus", "deep-snapper" = "pristipomoides filamentosus")
  
}

# process marlin simulations

## get MPA sizes

simple <- simple_state_experiments |> 
  select(state_id, depletion) |> 
  unnest(cols = depletion) |> 
  mutate(difficulty = "simple")

medium <- medium_state_experiments |> 
  select(state_id, depletion) |> 
  unnest(cols = depletion) |> 
  mutate(difficulty = "medium")

complex <- complex_state_experiments |> 
  select(state_id, depletion) |> 
  unnest(cols = depletion) |> 
  mutate(difficulty = "complex")

  state_depletions <- simple |> 
  bind_rows(medium) |> 
  bind_rows(complex) |> 
  mutate(state_id = glue("{difficulty}_{state_id}"))
  
  valid_state_depletions <- state_depletions |> 
    filter(depletion >= min_depletion)


simple <- simple_processed_sims$mpa_outcomes |> 
  mutate(difficulty = "simple")

medium <- medium_processed_sims$mpa_outcomes |> 
  mutate(difficulty = "medium")

complex <- complex_processed_sims$mpa_outcomes |> 
  mutate(difficulty = "complex")

# results of all marlin simulations
highres <- simple |> 
  bind_rows(medium) |> 
  bind_rows(complex) |> 
  mutate(state_id = glue("{difficulty}_{state_id}")) |> 
  mutate(id = glue("{difficulty}-{id}")) |> 
  mutate(prop_mpa = as_factor(prop_mpa))


simple <- simple_emulated_experiment_results |> 
  mutate(difficulty = "simple")

medium <- medium_emulated_experiment_results |> 
  mutate(difficulty = "medium")

complex <- complex_emulated_experiment_results |> 
  mutate(difficulty = "complex")

# results of all PT simulations
lowres <- simple |> 
  bind_rows(medium) |> 
  bind_rows(complex) |> 
  mutate(state_id = glue("{difficulty}_{state_id}")) |> 
  unnest(cols = mpa_experiment) |> 
  filter(year == max(year)) |> 
  mutate(prop_mpa = as_factor(prop_mpa))


tidy_lowres <- lowres |>
  mutate(percent_biomass = b_mpa / b_bau - 1,
         percent_catch = yield_mpa / yield_bau - 1) |>
  select(state_id, prop_mpa, critter, starts_with("percent")) |>
  pivot_longer(
    starts_with("percent"),
    names_to = "name",
    values_to = "lowres_percent_mpa_effect",
    names_prefix = "percent_"
  ) 

highres_vs_lowres <- highres |>
  filter(step == max(step)) |> 
  left_join(tidy_lowres, by = c("state_id", "name", "critter", "prop_mpa")) |> 
  filter(!is.na(lowres_percent_mpa_effect)) |> 
  left_join(state_depletions |> select(state_id, critter, depletion), by = c("state_id","critter")) |> 
  filter(depletion > min_depletion) |> 
  mutate(numeric_prop_mpa = as.numeric(as.character(prop_mpa)),
         critter = critter_namer(critter))

rm(list = c("simple", "medium", "complex"))


```

## Introduction

The field of ecology depends on models; it is how we move from simply *describing* ecological phenomena to *understanding* ecological processes. All models are abstractions of reality though, requiring scientists to make decisions as to how best to approximate the system in question to address the ecological question at hand. In some cases, these decisions can be be based simply on first principles such as our understanding of the basic physics of the universe. In many other cases we are faced with multiple competing models of the ecological process in question, with a common goal being the search for a "parsimonious" model that best explains the phenomena in question without containing extraneous features that may reduce the performance or efficiency of the model. For example, @murdoch2002 examined under what conditions a single-species model may or may not be a valid representation of population dynamics of species existing in a multi-species environment.While science has employed numerous practices for judging the performance of competing models, for much of recent history we have relied largely on confronting models with data [@hilborn1997], with the specific metric of model performance ideally determined based on the objective of the model [e.g. is the goal of the model data exploration, inference, or prediction, @tredennick2021a]. Regardless of the method, the key feature is that models are judged by their ability to explain observed data in some way shape or form.

The increasing "dimensionality" of questions asked by ecology (e.g. number of species, spatial and temporal scales), combined with the rapid increase in computation capabilities in the last few decades has greatly expanded the use of a slightly different class of model, which can generally be called "simulation models". The key feature of these models is that while they can perhaps be "tuned" to reality based on best available knowledge, they cannot be fit to data in a conventional statistical sense, either due to a lack of degrees of freedom (having many more parameters than available data), or an inability to measure the phenomena being simulated on a reasonable time scale.

These simulation models are extremely powerful, particularly as we increasingly turn to ecological sciences to help make complex policy decisions in a dynamic world. For example, the widely used Ecopath with Ecosim [@christensen2004] modeling framework allows for complex simulation of the effects of environmental and/or policy drivers on marine ecosystems that cannot realistically be directly evaluated empirically. However, this power comes with limitations, namely in that without the ability to rely solely on first principles or statistical confrontation with data it is unclear how we should judge the performance of alternative simulation models, particularly if alternative models provide conflicting guidance as to the impact of a phenomena or policy in question.

This challenge is well illustrated by the science of Marine Protected Areas (MPAs). While MPAs have taken and continue to take numerous forms throughout human history [@johannes1978; @grorud-colvert2021] , we refer to them here broadly as spatially defined areas in which some forms of human activities are restricted. The most conventional form of MPAs involve the restriction of some to all forms of extractive activities such as fishing without their borders. The exact form of these restrictions may vary but the choice of what is implemented is generally made to achieve some policy objective, for example protection of sensitive habitat, rebuilding of depleted fish populations, and support of food security or economic objectives.

The use of MPAs to achieve various policy objectives has exploded in recent years and looks to grow further, as best expressed by the goals of the 30x30 movement, which seeks to place 30% of terrestrial and marine ecosystems in some form of protected area by 2030 [@cbd2022]. While individual MPAs may differ in their specific objectives, they share a common theme that whatever the policy goal decisions must be made as to how to design a given MPA to achieve a given set of objectives, for example exactly where should the MPA be placed, how big should it be, and exactly what rules will be implemented within its borders.

The difficulty is that baring the most straight-forward of cases (e.g. protection of sensitive habitat of sessile species such as deep-water corals), determining how to design MPAs to achieve a given policy objective is almost entirely dependent on simulation models [@oleary2016]. This is due in large part to the scale of the processes involved in determining the outcomes of a given MPA or MPA network. Many marine organisms move vast distances at one or more parts of their life cycle [@gerber2005]. The impacts of protection can take years or decades to develop [@nickols2019]. This means that empirical studies of the net effect of MPAs inside and outside of their borders can require collection data over a large spatial scale over many years, an important but costly task. Even once those data are collected, observational studies lacking appropriate statistical controls can easily misdiagnose the effects of a spatial policy such as an MPA [@ovando2021; @ferraro2018].

Given then that we cannot realistically rely on experiments to design large-scale networks of MPAs, and lack the vast time series of data before and after MPAs at scale around the world to rely on observational methods, we must turn to simulation modeling to determining how to design MPAs that stand the best chance of achieving our policy objectives. A vast array of simulation models have been developed to fill this gap and help us project the potential policy impacts of MPAs [@fulton2015]. These models vary greatly in complexity, ranging from single species two-patch biomass dynamics models with analytical solutions [@hastings1999] to end-to-end spatially explicit social-ecological models with thousands of parameters such as ATLANTIS [@audzijonyte2019].

Several important works have surveyed the MPA modeling landscape. @gerber2003 reviewed a range of different MPA models and summarized the types of processes included and common insights across models. @pelletier2005 evaluated a wide range of MPA models and qualitatively scored their suitability for addressing different kinds of policy questions, but found that a very wide range of model complexities could be appropriate for broad questions like addressing "Enhancement of fisheries yield". @fulton2015 considered the landscape of models that have been used to model MPAs, and provided recommendations on the types of models that might be appropriate for asking different questions around MPAs. While this is an extremely important contribution to the literature, the list of models categorized as appropriate for particular MPA questions can span a vast range, from single-species population dynamics models up to more end-to-end style models such as [OSMOSE](https://osmose-model.org/publications/). Across these works then, while it is clear that some models are more capable than others of addressing certain types of questions, conditional on being capable of addressing a question (such as the impacts of MPAs on total catch), it remains unclear to what extent the choice of a specific viable model might influence the direction and magnitude of the effect being studied.

The ideal case in this modelling landscape is that complexity is additive in nature, meaning that all models capture the core processes around MPAs in an unbiased manner, but some are better capable of capturing finer-scale variation in MPA outcomes related to local context. If this is the case, then we would expect the predictions of say a two-patch biomass dynamics model to be right on average over a region, providing strategic guidance as to the potential outcomes of MPAs in that area, while a more detailed model is needed provide tactical advice for the design of a specific closed area. While this additive gradient in MPA model complexity would be ideal, we are unaware of any work that has explicitly tested whether it exists. Answering this question has real policy implications, particularly because models are the primary tool used to provide advice on MPA design [@oleary2016; @fulton2015]. If different models along a complexity gradient do not simply provide more detailed illustrations of the same image, but rather are painting completely different pictures, the predicted effects and subsequent design of MPA networks that will increasingly affect marine ecosystems and dependent peoples may simply be an artifact of the type of model selected rather than a reflection of a robust understanding of the dynamics of these social-ecological systems.

To illustrate the potential consequences of diverging predictions of alternative models, consider the case of @sala2021. That paper used a single species two-patch biomass dynamics modeling framework to predict the conservation and food security outcomes of a proposed global network of no-take MPAs, and as of publication of this paper is among the most highly cited and widely publicized findings in the recent marine conservation literature (<https://nature.altmetric.com/details/101895056>, noting that the outputs of this model are only one part of the broader results presented in @sala2021).However, @ovando2023 showed that minor changes to core untestable assumptions made by @sala2021 fundamentally altered both the total predicted outcomes of MPAs for food security and the prioritization map of this proposed global MPA network.

The question then is what models of MPAs are best suited for addressing which policy questions when multiple different models can in theory serve? The answer is mechanical in some cases. For example, if the goal of a given policy is to increase the mean length of a given target species, at minimum a model that tracks length is required. Conversely, if the goal of a given MPA is to rebuild the trophic structure of a fished ecosystem closer to unfished conditions, at minimum a multi-species model is needed. How though do we determine what model to use across a range of models that are all capable of tracking the same outcomes? For example, two commonly desired outcomes of MPAs are changes in total population biomass and total fishery catches. These metrics, or at least representations of them, are produced both by a two-patch biomass dynamics model and a full ecosystem model, and essentially every MPA model in between. It is unclear then how to decide which of the many models capable of simulation biomass and catch outcomes of MPAs is parsimonious for the task at hand.

The question of exactly what model is appropriate for what question related to spatial policies such as MPAs in marine social-ecological systems if far beyond the scope of this paper. However, this paper seeks to provide a step towards this broader goal by assessing whether models of differing complexity provide complimentary or contradictory predictions of the effects of MPAs across multiple policy dimensions. Specifically, we simulated a range of MPA outcomes using a spatially explicit age structured multi-species and multi-fleet simulation framework presented in @ovando2023a called `marlin`. We then tuned a two-patch biomass dynamics model presented in @ovando2023 and based on @cabral2020, the foundation for the results presented in @sala2021, to emulate the simulated dynamics of the more complex `marlin` model. We compared the effects of no-take MPAs predicted by these two models, and evaluated if and when the two models were in agreement. While these are only two models out of the many available to model MPAs, they are instructive as both types of models have been used to provide predictions of the effects of MPAs on biomass and catch. We find evidence that rather than existing along a gradient of strategic to tactical, the two models provided vastly different and often contradictory predictions of the outcomes of MPAs for food security and conservation.

## Methods

This paper uses two general classes of models that we call the *High-* and *Low-definition* models. The *High-definition* model uses a framework called `marlin` described in @ovando2023a . The `marlin` model simulates arbitrary numbers of independent age-structured fish-like populations distributed in a two-dimensional seascape. These fish populations can be targeted by arbitrary numbers of fishing fleets each of which can have individual *métiers* that specify the relationship between a given fleet and a specific fish species. The *Low-definition* model is two-patch Pella-Tomlinson [@pella1969] surplus production model, described in @ovando2023 and based on @cabral2020.

Each simulation follows the same general structure:

1.  Generate a set of state variables (e.g. life history parameters and fleet dynamics) from a range of *simple* (one species one fleet), *medium* (four species one fleet), and *complex* (four species two fleets) scenarios (@tbl-scenes)
2.  Run the simulation with those state variables (@tbl-states) using the *High-definition* model
3.  Generate data from the *High-definition* model and use it to estimate the parameters of the *Low-definition* model
4.  Apply a range of MPA designs comprised of size (percent of seascape) and placement strategy for the *High-definition* case, and size only for the *Low-definition* model
5.  Compare the percent change in biomass and catch predicted by the *High* and *Low-definition* models

We note that this paper involves a great deal of code that cannot realistically be translated in full into the text of the methods section here. As such, the code needed to reproduce this paper and all results contained within can be accessed and run through the repository available at https://github.com/DanOvando/mpa-indicators-and-emulators.

### High-definition Model and Simulations

The equations and processes describing `marlin` model used in the *High-definition* are presented in detail in @ovando2023a. Briefly, the model simulates fish populations using an age-structured population. Length-at-age is calculated using the von Bertalanffy growth equation with log-normally distributed variation in the length at age. Natural mortality at age is calculated using the length-inverse mortality function described in @lorenzen2022. Fecundity at age is a function of weight at age, with the potential for hyperallometric fecundity in which fecundity increases faster than weight. Recruitment follows a Beverton-Holt dynamics parameterized around steepness (*h*), with multiple options for the timing and spatial scale of density dependence (e.g. local vs. global or pre- vs. post-dispersal). Movement is simulated using a continuous-time Markov chain (CTMC), as described in @thorson2021a. This process breaks movement in a diffusion and taxis component, where the taxis component allows fish to preferentially move towards better habitat. The model runs in 6-month time steps for these simulations. Core life history values are pulled from `Fishlife` [@thorson2020].

Fishing fleets are simulated based on effort. Each fleet exerts an amount of fishing effort in a time step, and chooses how to allocate that effort in space based on a spatial-allocation strategy (e.g. revenue-per-unit-effort in the previous time step). Effort in a given patch applies fishing mortality to simulated species based on the *métier* in question. The *métier* specifies the contact selectivity at age of that fleet for each simulated species, the price per unit weight for each species, and the proportion of the total fishing mortality experienced by that fish species contributed by the *métier* in question. Fishing fleets can have home ports, which add a cost to fishing in a given patch that increase with linear distance from the home port.

Together, these fish and fleet dynamics allow `marlin` to simulate the effects of multiple fishing fleets on multiple species. For example, by simulating multiple fleets and fish species simultaneously, the model can capture bycatch dynamics in which a fleet targets one species but incidentally captures another species if it occurs in the same location as the target species.

#### Simulated States

The four possible species simulated are a grouper (*Epinephelus fuscoguttatus*, Serranidae), a shallow-reef snapper (*Lutjanus malabaricus*, Lutjanidae), a deep-reef snapper (*Pristipomoides filamentosus*, Lutjanidae), and a reef shark (*Carcharhinus amblyrhynchos*, Carcharhinidae). Two possible fleets are simulated. The parameters of each fleet, e.g. selectivity and price for a given species, are randomly drawn. When two fleets are simulated, fleet $\alpha$ primarily targets the grouper and shark species, fleet $\beta$ primarily targets the two snapper species, though both fleets catch all four species to some extent. The set of scenarios evaluated are shown in @tbl-scenes.

::: {#tbl-scenes}
| Name      | Species                                 | Fleets               |
|-----------|-----------------------------------------|----------------------|
| *simple*  | *Snapper*                               | $\alpha$             |
| *medium*  | *Snapper, Deep-Snapper, Grouper, Shark* | $\alpha$             |
| *complex* | *Snapper, Deep-Snapper, Grouper, Shark* | $\alpha$ and $\beta$ |

Description of the three categories of simulation states evaluated.
:::

For each scenario set we simulated `r n_distinct(state_depletions$state_id) / 3` states. Each state was generated by drawing a random variable from the sets described in @tbl-states.

::: {#tbl-states}
| Name                          | Description                                                                                                                       |
|-----------------------|-------------------------------------------------|
| KISS                          | Keep it Simple Stupid. When TRUE, sets habitat equal in all patches for all species                                               |
| MPA response                  | Dictates whether effort that used to fish inside MPAs "stays" and is redistributed or "leaves" the fishery                        |
| Habitat patchiness ($\kappa$) | Low values create smooth habitat, higher values patchy habitat                                                                    |
| Max absolute correlation      | Scales the maximum absolute correlation between species                                                                           |
| Spatial catchability          | Whether catchability of the fishing fleets varies in space                                                                        |
| Spatial fleet allocation      | How the fleet distributes itself in space, one of revenue, profit per unit effort, and revenue per unit effort                    |
| Seasonal movement             | Whether habitat flips in one half of the year to another                                                                          |
| Spawning aggregation          | Whether spawning occurs in a concentrated location                                                                                |
| Fishing vs. Natural mortality | Ratio of instantaneous fishing mortality rate relative to natural mortality. The higher this is, the lower $B_{bau}/B_0$ will be. |
| Adult diffusion               | The diffusion rate of "adult" (non-larval) fish                                                                                   |
| Larval diffusion              | The diffusion rate of the larval fish                                                                                             |
| Steepness                     | Beverton-Holt steepness value                                                                                                     |
| b0                          | The unfished biomass for a given species                                                                                 |
| Hyperallometry                | Degree of hyperallometry in fecundity at age relationship                                                                         |
| Density dependence            | The timing of density dependence, one of "global_habitat", "local_habitat", "pre_dispersal", "post_dispersal".                    |
| Ontogenetic shift             | Whether recruitment habitat is the inverse of adult habitat                                                                       |
| Use ports?                    | Whether or not to assign ports to individual fleets that alter cost per unit effort in patches                                    |
| Selectivity at age            | Selectivity at age, set separately for every *métier*                                                                             |
| Price per unit weight         | Price per unit weight for every *métier*                                                                                          |

Variables that define a given simulation state. See accompanying code at https://github.com/DanOvando/mpa-indicators-and-emulators for details of individual distributions.
:::

#### Simulating Habitats

Marine species are often distributed heterogeneously in space with various degrees of covariance among species, i.e. some species tend to be found together, others tend to be found apart, and those distributions can be clustered in space. We modified the methods described in @thorson2017a to automate simulation of these spatial habitat dynamics. The key parameters process is a parameter $\kappa$ that dictates the rate at which correlation among patches decrease with distance from each other. $\kappa$ is \>0. The closer $\kappa$ is to 0, the greater the distance at which habitat among patches are still correlated becomes. The larger $\kappa$ becomes, the less correlated habitat becomes with distance. The other parameter is a *c* by *c* matrix **R**, where *c* is the number of species being simulated. The upper-triangle of **R** is the correlation (bounded between -1 and 1) in habitat between each simulated species. A value of 1 indicates that that given pair share habitat perfectly, -1 that they share no habitat. When only one species is present, **R** has no effect.

Together then $\kappa$ dictates how "patchy" a simulated seascape is, with lower values producing a smoother habitat distribution per species, and **R** dictates how similar the habitats are across species. Generating random draws of $\kappa$ and **R** allows us to automatically generate simulations that range from essentially uniform habitats across species to cases where habitat is patchy and individual species tend to avoid each other [@fig-hab].

```{r}
#| label: fig-hab
#| fig-cap: "Example simulated habitat distributions. Each panel is one species, color shows the scaled number of individuals in each patch under unfished conditions."

knitr::include_graphics(file.path(fig_dir,"complex_state_50_habitat.pdf"))

```

### Low-definition Model

Much of the early MPA modeling literature used various forms of "surplus production" models [see @kokkalis2024] often using a two-patch system in which MPAs are modeled by tracking total biomass in each patch while adjusting the relative size of patches and setting fishing mortality to zero in the MPA patch [@gerber2003]. While much more detailed models have been developed since then, these types of models are still used, particularly in cases where the goal is to simulate large number of fisheries or states [e.g. @sala2021].

The form of two-patch surplus production model used here is the same Pella-Tomlinson structure used in @costello2016 although modified to allow for the kinds of two-patch MPA dynamics used in @sala2021. The equations are as follows, where *B* is biomass, *t* is time, $\phi$ scales the shape of the production curve (when $\phi$ = 0.188 $B_{MSY}/K = 0.4$), *g* is the growth rate, *K* is the carrying capacity, *R* is the proportion of the total carrying capacity inside the MPA, $F$ is the fishing mortality rate, and *m* is the movement rate:

$F$ can be calculated with or without effort displacement. When effort displacement is turned off, total F is constant.

$$F_t = F_{BAU}$$

When effort displacement is turned on, fishing mortality outside the MPAs increases proportionally to the size of the protected area, in the same manner as @sala2021 .

$$F_t = 1 - (1 - F_{BAU})^{\frac{1}{1 - R}}$$

Under "local" density dependence, the population model is

$$
\begin{aligned}
B_{t+1,MPA = 1} = B_{t,MPA = 1} + \frac{\phi + 1}{\phi}gB_{t,MPA = 1} \left(1 - \left(\frac{B_{t,MPA = 1}}{K \times R}\right)^{\phi} \right) \\ - m(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA = 0}).
\end{aligned}
$$

$$
\begin{aligned}
B_{t+1,MPA = 0} = (1 - F_{t}) \times ( B_{t,MPA = 0} + \frac{\phi + 1}{\phi}gB_{t,MPA = 0} \left(1 - \left(\frac{B_{t,MPA = 0}}{K \times (1 - R)}\right)^{\phi} \right) \\ +  m\left(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA= 0}\right) ).
\end{aligned}
$$

Under "pooled" density dependence, the population model is

$$B_{t,Total} = B_{t,MPA = 1} + B_{t,MPA = 0},$$

$$
\begin{aligned}
B_{t+1,MPA = 1} = B_{t,MPA = 1} + R \frac{\phi + 1}{\phi}gB_{t,Total} \left(1 - \left(\frac{B_{t,Total}}{K}\right)^{\phi} \right) \\ -  m\left(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA=0}\right).
\end{aligned}
$$

$$
\begin{aligned}
B_{t+1,MPA = 0} = (1 - F_{t}) \times ( B_{t,MPA = 0} + (1 - R) \frac{\phi + 1}{\phi}gB_{t,Total} \left(1 - \left(\frac{B_{t,Total}}{K}\right)^{\phi} \right) \\ +  m\left(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA=0}\right) ).
\end{aligned}
$$

The model uses "local" density dependence when the form of density dependence used in the High-definition model is in some way local, and "pooled" when the High-definition model density dependence is in some way global.

#### Fitting Low-definition Model

The Low-definition model has five core parameters: $\phi$, *g*, *m*, *K*, and *D*, where *D* is the depletion (B/K) at the start of the simulation. Clearly all of these parameters could be made up. However, the goal of this paper is to assess the impact of model structure on simulated outcome, holding as much else constant as possible. This means that we want to find values of these parameters that allow the Low-definition model to best match the dynamics of the High-definition model.

To achieve these, we estimated these five parameters along with required variance parameters using the Stan programming language and the cmdstanR [@cmdstanr2023] interface. For a given scenario *s* simulated by the High-definition model, we created the following experiment.

1.  Fish each population from unfished biomass B0 down to a depletion of 0.1 B0, generating a vector of total biomass **bdep** and catch **cdep** over time.
2.  From that depletion of 0.1 B0, move all the fish to the left-hand side of the simulated seascape, such that the right 50% of the seascape is empty of fish.
3.  Close the seascape to fishing, and then let the population rebuild and disperse, create a vector of biomass in the left-hand **bleft** and right-hand **bright** side of the seascape as the population approaches B0 again and fills in the right-hand side of the seascape through adult movement and larval dispersal.
4.  Pass **bdep,cdep,bleft, bright** to the *Low-definition* estimation model to estimate the parameters of the model.

The concept here is that **bdep** and **cdep** provide information on the scale of the population (B0,unfished biomass, and the volume of catch the population can sustain), where as **bleft** and **bright** provide additional information on *g*, $\phi$, and *m*, as the model can see how fast the population grows from a depleted state as a function of biomass, and how fast the population recolonizes the right-hand patch.

The structure of the model is given below, variables with $\hat{}$ indicate estimates by the model. Prior distributions were selected to be generally uninformative while providing some guidance as to the general parameter space of the variables. This model could be refined, but provides a general means for quickly and robustly fitting the data generated by the *High-definition* model.

$$
log(bdep) \sim N(log(\hat{bdep}),\sigma_b)
$$

$$
log(cdep) \sim N(log(\hat{cdep}),\sigma_c)
$$

$$
log(bright) \sim N(log(\hat{bright}),\sigma_b)
$$

$$
log(bleft) \sim N(log(\hat{bleft}),\sigma_b)
$$

$$
log(K) \sim N(10,2)
$$

$$
m \sim N(0.2,0.2), 0 < m < 1
$$

$$
\sigma_b \sim N(0.05,0.1), \sigma_b > 0
$$

$$
D \sim N(0.5,0.5) ,0 < D < 1
$$

$$
log(phi) \sim N(log(0.188),0.4))
$$

The model was fit using penalized maximum likelihood through the `cmdstan` `optimize` function rather than fit using full Bayesian inference, in order to speed up computation and since we are not interested in examining uncertainty in this analysis. Models that failed to converge were discarded from the process (a very small number). We confirmed that this model was capable of recovering simulated parameters when fit to data generated by itself, and confirmed that the model was able to match the data generated by the High-definition model as well as possible given the presence of model misspecification (i.e. that the Low- and High-definition models have fundamentally different assumptions). Once the Low-definition parameters were estimated for a given state, the Low-definition model was then run through the appropriate MPA scenarios.

### MPA Placement Scenarios

MPAs in this simulations are defined as fully no-take MPAs for all of the species simulated in a given iteration of the model. MPA size is defined by the proportion of the seascape placed inside the MPA. In the *High-definition* case, this is the proportion of cells in the two-dimensional space. In the *Low-definition* case, this is the patch size parameter *R*.

The *High-definition* case must also decide which patches will be used to achieve a given MPA size. The three possible options are:

1.  *target_fishing*: place MPAs in descending order of catch per patch
2.  *avoid_fishing*: place MPAs in ascending order of catch per patch
3.  *area*: start placing MPAs in bottom left corner of seascape and build up from there

A given placement scenario *p* then is the intersection of the proportion of the seascape in an MPA and the strategy for placing the MPA patches.

### Types of Results

For each simulation, both the *High-resolution* and *Low-resolution* models start at the same business-as-usual depletion level ($B_{bau} /  B_{0}$), the biomass level that would occur in the absence of the MPA. Both resolution models are then simulated forward in time 50 years with and without the selected MPA designs. Each simulation (a combination of scenario, state and placement) produces simulated biomass per species and catch per species per fleet with and without MPAs for the *Low-* and *High-definition* models. We measured the effect sizes of the MPAs (MPAE) for state *s* and MPA placement scenario *p* for model type *m* as percentage differences in the outcome in question

$$
MPAE_{s,p,m} = \frac{Outcome_{MPA=1,s,p,m}}{Outcome_{MPA=0,s,p,m}} -1 
$$

Where *Outcome* is one of catch or biomass in the water. We then calculate the percentage point difference between the two models as

$$
\Delta_{s,p} = MPAE_{s,p,m=Low} - MPAE_{s,p,m=High}
$$

Readers may be used to seeing differences in fishery outcomes measured in changes in maximum sustainable yield (MSY) based reference points such as the biomass relative to the biomass capable of producing MSY (B/BMSY) and the fishing mortality relative to the fishing mortality that would result in BMSY at equilibrium (F/FMSY). While these quantities are defined for the *Low-definition* model, they are much more complex for the *High-definition* model. This is because MSY is a function both of life history and selectivity, and under the *High-definition* models selectivity can vary both among fleets and across space. This means that the MSY-based reference points would need to be recalculated for every equilibrium fleet distribution at a given MPA size, and could potentially lead to confusing results such as B/BMSY increasing even as B decreases if changes to the fleet result in BMSY decreasing. See @kapur2021 for a discussion of these challenges. As such, we present percentage changed based summaries of results.

## Results

The results of this analysis take the form of paired predictions of the *High-definition* and *Low-definition* models for a given combination of state *s*, placement strategy *p*, and percent of seascape in MPA (*pmpa*). For each instance. data are generated by the *High-definition* model based on the parameters of the *state*, which are then used to estimate parameters for the *Low-definition* model. Given these parameters, a range of MPA sizes are applied to the *High-* and *Low-definition* models, with placement rules for strategy *p* dictating where the MPA goes in the *High-definition model* (there is no placement option for the Low-definition model as the two-patch dynamics do not allow it).

Possibly the clearest and most consistent prediction from the MPA modelling literature is that more heavily fished species are more able to benefit from MPAs, both in terms of biomass and catch. Given that, in many of the results we analyze the role of fishing pressure in outcomes, expressed as $B_{bau}/B_0$ , the biomass under "business as usual" relative to unfished biomass. The lower this value, the more depleted the species in question is.

### Example Trajectories {#sec-eg}

@fig-eg-simple and @fig-eg-complex illustrate the kinds of outcomes produced by this simulation exercise. @fig-eg-simple shows a result from the *simple* set of scenarios, in which the High-definition model has only one species and one fleet. In this case. @fig-eg-complex shows a result from the *complex* set of scenarios, in which the High-definition model simulations four different species deferentially targeted by two different fishing fleets.

```{r}
#| label: fig-eg-simple
#| fig-cap: "Example simulated effects of MPAs on biomass and catch under the 'simple' scenario (*High-definition* model only has one species and one fleet). X-axis shows the percent of the seascape protected in a no-take MPA. Y-axis shows biomass divided unfished biomass (A) or catch (B). Panel columns show MPA placement strategy used in *High-definition* model."


i <- 42

i <- as.integer(sample(unique(simple_emulated_experiment_results$state_id),1))

# i <- 48

# test <- simple_state_experiments |> 
#   filter(state_id == 48)

emulation <- simple_emulated_experiment_results |> 
  filter(state_id == i) |> 
  unnest(cols = mpa_experiment) |> 
  filter(year == max(year)) 

reality <- simple_processed_sims$mpa_outcomes |> 
  mutate(state_id = as.integer(state_id)) |> 
  filter(state_id == i)

a = ggplot() +
  geom_line(
    data = reality |> filter(name == "biomass"),
    aes(prop_mpa, value / b0, color = "High-definition Model")
  ) +
  geom_point(data = emulation, aes(prop_mpa, depletion_mpa, color = "Low-definition Model")) +
  scale_y_continuous(limits = c(0, 1), name = "~B/B0") + 
  scale_x_continuous(name = "MPA Size", labels = scales::percent, guide = guide_axis(n.dodge = 2)) +
  facet_wrap(~placement_strategy) + 
  labs(title = "A") + 
  scale_color_discrete(name = '')

b = ggplot() +
  geom_line(
    data = reality |> filter(name == "catch"),
    aes(prop_mpa, value, color = "High-definition Model")
  ) +
  geom_point(data = emulation, aes(prop_mpa, yield_mpa, color = "Low-definition Model")) +
  scale_y_continuous(limits = c(0, NA), name = "Catch") + 
  scale_x_continuous(name = "MPA Size", labels = scales::percent, guide = guide_axis(n.dodge = 2)) +
  facet_wrap(~placement_strategy) + 
  labs(title = "B") + 
    scale_color_discrete(name = '')



fig <- (a | b) + plot_layout(guides = "collect", heights = c(1,1.5)) & theme(legend.position = "bottom", axis.text.x = element_text(size = 8))

figsaver(fig)

```

```{r}
#| label: fig-eg-complex
#| fig-cap: Example simulated effects of MPAs on biomass and catch under the 'complex' scenario (*High-definition* model has four species targeted by two fleets). X-axis shows the percent of the seascape protected in a no-take MPA. Y-axis shows biomass divided unfished biomass (A) or catch (B). In *A*, color indicates species points are the *Low-definition* model and lines are the *High-definition* model. In *B*, color indicates the fleet, and each row of the panel is a separate species. Panel columns show MPA placement strategy used in *High-definition* model.
#| fig-height: 6



i <- 42

i <- as.integer(sample(unique(complex_emulated_experiment_results$state_id),1))

emulation <- complex_emulated_experiment_results |> 
  filter(state_id == i) |> 
  unnest(cols = mpa_experiment) |> 
  filter(year == max(year)) |> 
    mutate(critter = critter_namer(critter))


reality <- complex_processed_sims$mpa_outcomes |> 
  mutate(state_id = as.integer(state_id)) |> 
  filter(state_id == i) |> 
  mutate(critter = critter_namer(critter))


a = ggplot() +
  geom_line(
    data = reality |> filter(name == "biomass"),
    aes(
      prop_mpa,
      value / b0,
      color = critter
    )
  ) +
  geom_point(data = emulation, aes(prop_mpa, depletion_mpa, color = critter)) +
  scale_y_continuous(limits = c(0, NA), name = "~B/B0") +
  scale_x_continuous(name = "MPA Size", labels = scales::percent, guide = guide_axis(n.dodge = 2)) +
  scale_color_viridis_d(name = '') +
  facet_wrap( ~ placement_strategy) + 
  guides(color = guide_legend(nrow = 2))

b = ggplot() +
  geom_line(
    data = reality |> filter(name == "catch") |> mutate(fleet = paste0("High-definition Fleet ",fleet)),
    aes(prop_mpa, value, color = fleet)
  ) +
  geom_point(data = emulation |> mutate(fleet = "Low-definition Fleet"), aes(prop_mpa, yield_mpa, color = fleet)) +
  scale_y_continuous(limits = c(0, NA), name = "Catch") + 
  scale_x_continuous(name = "MPA Size", labels = scales::percent, guide = guide_axis(n.dodge = 2)) +
  facet_grid(critter~placement_strategy,scales = "free") + 
  scale_color_brewer(name = '',palette = "Accent") +
  guides(color = guide_legend(nrow = 2)) + 
  theme(strip.text.y = element_text(size = 6))

fig <- (a | b) & theme(legend.position = "bottom", axis.text.x = element_text(size = 8), strip.text = element_text(size = 7)) + plot_layout(guides = "collect")

figsaver(fig)

```

```{r}

# not including for now since somewhat misleading since area != K protected in marlin model

# make a figure plotting yield maximizing MPA size PT vs marlin, and MSY PT vs marlin

# pull out the size and outcome of MPA that maximizes catch for highres and lowres scenarios
highres_max_catch <- highres |> 
  filter(name == "catch") |> 
  group_by(critter, state_id, placement_id) |> 
  filter(value == max(value)) |> 
  select(state_id, critter, placement_id, prop_mpa, value,difficulty,percent_mpa_effect, kiss, spatial_q) |>
  rename(highres_prop_mpa = prop_mpa, highres_catch = value, highres_catch_percent = percent_mpa_effect)

lowres_max_catch <- lowres |> 
  group_by(critter, state_id) |> 
  filter(yield_mpa == max(yield_mpa)) |> 
  mutate(lowres_catch_percent = yield_mpa / yield_bau - 1) |> 
  rename(lowres_prop_mpa = prop_mpa, lowres_catch = yield_mpa)

compare_max_catch_mpa <-  highres_max_catch |>
  right_join(lowres_max_catch, by = c("critter", "state_id", "difficulty"))

```

### Low-definition Compared to High-definition {#sec-compare}

```{r}
#| label: fig-msy-size
#| fig-cap: "Percent of seascape protected in MPA that maximizes catch predicted by the *High-definition* model (x-axis) and *Low-definition* model (y-axis)"
#| eval: false


compare_max_catch_mpa |>
  mutate(highres_prop_mpa = as.numeric(as.character(highres_prop_mpa))) |> 
  mutate(lowres_prop_mpa = as.numeric(as.character(lowres_prop_mpa))) |> 
  ggplot(aes(highres_prop_mpa, lowres_prop_mpa)) +
  geom_bin_2d(bins = 10) +
  geom_abline(slope = 1, intercept = 0) +
  scale_x_continuous(limits = c(NA, 1), oob = squish, labels = scales::percent, name = "Highres Catch Maximizing MPA") +
  scale_y_continuous(limits = c(NA, 1), oob = squish,labels = scales::percent, name = "Lowres Catch Maximizing MPA") + 
  facet_grid(kiss ~ difficulty) 
```

Each *state*, *placement strategy* and *MPA size* is associated with predictions of percent change in biomass and catch for each species from the *Low-* and *High-definition* models (noting that fleet-specific predictions are only possible for the *High-definition* model results). Plotting the *Low-definition* versus the *High-definition* predictions provides a measure of the degree of agreement between these two models. Examining first changes in biomass, the *Low-definition* model predictions are almost universal positively biased, meaning that across nearly every simulation the *Low-definition* model predicted a higher percent increase in biomass than the *High-definition* model, often substantially so. The main area of agreement between the *Low-* and High-definition models is that the potential increases in biomass are positively correlated with the degree of fishing pressure (as measured by BAU depletion, $B_{bau}/B_0$). Under the dynamics of the *Low-definition* model, it is impossible for an MPA to result in a net decrease in biomass, whereas this result is possible under the *High-definition* model, due in the case of this model to effort displacement from the MPA onto habitat of highly depleted species. The complexity of the simulation state had little impact on the biomass results, indicating that the basic presence of age structure and two-dimensional spatial dynamics is enough to cause this discrepancy in predicted percent changes in biomass caused by an MPA (@fig-hi-v-low).

Examining the catch results (@fig-hi-v-low), the *Low-definition* models had a relatively clear cutoff point where depletion values greater than 0.25 were less likely to provide positive catch benefits. In contrast, the *High-definition* models predicted positive catch effects across many levels of depletion. This may seem counter-intuitive, as the literature and basic biology is fairly clear that MPA can only increase catch if the population was overfished in the first place. The increased catches under higher depletion levels (lower fishing pressure) predicted by the *High-definition* model come under the *avoid_fishing* placement strategies, specifically where the fleet is concentrated in remaining fishing grounds given a constant effort fleet model and the assumption of MPA displacement rather than attrition. As with the biomass results, while there is a positive correlation between the predicted catch effects of MPAs of the *Low-definition* and *High-definition* models the relationship is quite weak and generally positively biased, meaning that the *Low-definition* model on average predicted higher increases in catch from MPAs than its paired *High-definition* model. The catch-based results are more sensitive to the complexity of the simulation, in particular the addition of a second fleet in the *complex* scenarios, than the biomass results.

```{r}
#| label: fig-hi-v-low
#| fig-cap: Percent change in biomass (top row) and catch (bottom row) resulting from MPAs covering between 10-40% of the simulated seascape predicted by the High-definition (x-axis) and Low-definition (y-axis) models. Panel columns correspond to the simulation set used. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA. Plotted effect sizes are capped at 200%. 


fig <- highres_vs_lowres |> 
  filter(between(numeric_prop_mpa,0.1,0.4)) |> 
  ggplot(aes(lowres_percent_mpa_effect,percent_mpa_effect, color = depletion)) + 
  geom_hline(yintercept = 0) + 
  geom_vline(xintercept = 0) +
  geom_abline(slope = 1, intercept = 0, color = "tomato") +
  geom_smooth(method = "lm") +
    geom_point(alpha = 0.1) + 
  facet_grid(name~fct_rev(difficulty)) +
  scale_y_continuous(
    name = "High-definition % MPA Effect",
    labels = scales::percent,
    limits = c(NA, 2),
    oob = squish
  ) +
  scale_x_continuous(
    name = "Low-definition % MPA Effect",
    labels = scales::percent,
    limits = c(NA, 2),
    oob = squish
  ) +
  scale_color_viridis_b(name = "BAU B/B0", option = "mako", direction = 1) +
  theme(legend.position = "top")

figsaver(fig)

```

We quantified the differences between the Low- and High-definition models by calculating $\Delta$ as the difference in the percentage point effect predicted by the *Low-* and *High-definition* models (@fig-delta). A positive value of $\Delta$ indicates that the *Low-definition* model predicted a higher percent change in the given metric than the *High-definition* model, and *vice versa*. The *Low-definition* model consistently overestimated the percent increase in biomass caused by a given MPA across all levels of $B_{bau}/B_0$ . When $B_{bau}/B_0$ was low, the level of positive bias followed a dome-shaped pattern, peaking around median bias of roughly 150 percentage points between MPA sizes of roughly 30-60%. When $B_{bau}/B_0$ values were higher, the level of bias was lower at smaller MPA sizes but increased as MPA size increased. Higher levels of $B_{bau}/B_0$ had lower bias levels, as the models tended to agree more that the closer a population was to unfished biomass, the less scope for percentage increases in biomass is possible. Predicted catch effects were less biased than predicted biomass effects, particularly at smaller MPA sizes. The *Low-definition* model was more likely to overestimate catch effects when $B_{bau}/B_0$ was low, but across all levels of $B_{bau}/B_0$ the *Low-definition* model started to become generally negatively biased (meaning it underestimated the potential increase in catch) as MPA size increased. However, while patterns in the direction of bias exist, across all scenarios and levels of $B_{bau}/B_0$ the range of $\Delta$ values were generally extremely large, generally spanning 50 to 200 percentage points.

```{r}
#| label: fig-delta
#| fig-cap: Distribution of percentage point difference (*Low-definition* minus *High-definition*) in predicted MPA effect size on biomass (top row) and catch (bottom row) (y-axis) as a function of percent of seascape in MPA (x-axis). Positive y-axis values indicates that the Low-definition predicts a more positive effect than the High-definition model, negative a more negative effect. Columns indicate simulation set used. Line is median value, bands are 50% and 90% interquantile ranges, respectively. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA.  Plotted delta values sizes are capped at 200 percentage points. 

fig <- highres_vs_lowres |>
  mutate(prop_mpa = as.numeric(as.character(prop_mpa))) |> 
  mutate(
    delta =   (pmin(lowres_percent_mpa_effect, 2) - pmin(2, percent_mpa_effect)),
    delta2 = delta ^ 2
  ) |>
  select(contains("percent"), delta2, everything()) |>
  mutate(depbin = cut(depletion,breaks = seq(0,1,by = 0.25))) |> 
  ggplot(aes(prop_mpa,100 * delta , fill = depbin, color = depbin)) +
  geom_hline(yintercept = 0) +
  stat_lineribbon(na.rm = TRUE, alpha = 1/4, .width = c(0.5,0.9)) +
  facet_grid(name ~ fct_rev(difficulty), scales = "free_y") + 
  scale_y_continuous(name = "Percentage Points Difference") + 
  scale_x_continuous(name = "% Seascape in MPA", labels = scales::percent) + 
  scale_color_viridis_d(name = "BAU B/B0", option = "mako", direction = 1) +
  scale_fill_viridis_d(name = "BAU B/B0", option = "mako", direction = 1) + 
  theme(legend.position = "top")

figsaver(fig)

```

Looking across the simulations, for each *state* and *placement strategy* both the *Low-* and *High-definition* models provide a prediction of the maximum percent increase in catch that could be achieved through use of MPAs. Both models broadly agree that the potential for MPAs to increase broadly proportional to the magnitude of fishing pressure without the MPA. For simulations in which the fished population was heavily depleted, the *Low-definition* model consistently predicted much greater potential increases in catch than the *High-definition* model. When the fished population was less heavily depleted, the *High-definition* model generally predicted greater potential for increased catch than the *Low-definition* model, though this was sometimes a result of increasing fishing pressure rather than rebuilding populations. In general, there was some positive correlation between the maximum predicted catch potential from the *Low-* and *High-definition* models, but the relationship was very loose [@fig-max-catch].

```{r}
#| label: fig-max-catch
#| fig-cap: "Maximum potential percent increase in catch caused by an MPA predicted by the High-definition (y-axis) and Low-definition (x-axis) models. Facets indicate simulation set. Plotted effect sizes are capped at 200%."

fig <- compare_max_catch_mpa |> 
  ggplot(aes(lowres_catch_percent,highres_catch_percent)) + 
  # geom_bin_2d(bins = 15) + 
  geom_point(aes(color = depletion), alpha = 0.5,size = 2) +
  geom_abline(slope = 1, intercept = 0) + 
  facet_wrap(~fct_rev(difficulty)) + 
  scale_y_continuous(limits = c(NA, 2), oob = squish, labels = scales::percent, name = "High-definition Max Potential Catch Increase") +
  scale_x_continuous(limits = c(NA, 2), oob = squish,labels = scales::percent, name = "Low-definition Max Potential Catch Increase") + 
  scale_color_viridis_b(name = "BAU B/B0", option = "mako", direction = 1) +
  theme(legend.position= "top")

figsaver(fig)

```

Rather than comparing specific predictions of percent point changes of biomass and catch, we can also compare the "rank" of each fishery, in terms of biomass or catch potential from MPAs, predicted by the *Low-* and *High-definition* models. This can be useful if the goal of the modeling exercise is not to make explicit statements about the magnitude of changes, but simply to identify which sites might be most amenable to achieving benefits to conservation, food security, or both through MPAs. To that end we grouped simulations by MPA size and then ranked the change in biomass and catch for each simulated fishery conditional on a given MPA size. This provides a prediction of, if we were to protect a given percentage of a seascape in an MPA, which fisheries stand to benefit the most and the least (@fig-ranks).

Both the *Low-* and *High-definition* models agreed that for both catch and biomass, the highest rank fisheries were those with the lowest $B_{bau}/B_0$ values. For the *simple* scenarios, there was near 100% agreement in the top-ranked fisheries for both biomass and catch. However, in the *complex* scenarios there was less agreement between the models even at the top ranks. Beyond the top tanks, while both models had similar trends, there was substantial variation in the specific rank predicted by the two models, particularly for catch; for the *complex* scenarios, fisheries ranked in the top 75% by the *Low-definition* models could be anywhere between near the bottom 0 or top 95% according the *High-definition* model.

```{r}
#| label: fig-ranks
#| fig-cap: Percent rank of individual fisheries (intersection of fleet and species) conditional on proportion of seascape protected in a no-take MPA predicted by High-definition (x-axis) and Low-definition (y-axis). Higher percent rank indicates that an MPA is predicted to have more positive outcomes for a given fishery, lower worse outcomes. Top row shows results for biomass, bottom row shows results for catch. Columns indicate simulation set. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA. 

fig <- highres_vs_lowres |>
  group_by(prop_mpa, name, difficulty) |>
  mutate(
    highres_rank = percent_rank(percent_mpa_effect),
    lowres_rank = percent_rank(lowres_percent_mpa_effect)
  ) |> 
  arrange(highres_rank, desc(lowres_rank)) |> 
  ggplot(aes(lowres_rank,highres_rank)) + 
  geom_abline(slope = 1, intercept = 0, color = "tomato") +
    geom_point(alpha = 0.05, aes(color = depletion)) +
  facet_grid(name~fct_rev(difficulty), scales = "free") +
  scale_y_continuous(
    name = "High-resolution % Rank",
    labels = scales::percent,
    limits = c(0, 1),
    oob = squish
  ) +
  scale_x_continuous(
    name = "Low-resolution % Rank",
    labels = scales::percent,
    limits = c(0, 1),
    oob = squish
  ) +
  scale_color_viridis_b(name = "BAU B/B0", option = "mako", direction = 1) + 
  theme(legend.position = "top")

figsaver(fig)
```

The objective of an MPA modeling exercise may be even coarser than rankings, simply asking which fisheries might benefit or lose in terms of biomass and catch for a given MPA size. To assess this use case, we assigned each of our simulation results to one of five quadrants:

1.  Biomass increases and catch decreases
2.  Biomass increases and catch increases
3.  Biomass decreases and catch decreases
4.  Biomass decreases and catch increases
5.  No effect (neither biomass or catch changes by $\pm$ 5%)

This can be viewed as a "diagnosis" problem, where the *Low-definition* model predicts the quadrant a given MPA will place a fishery in, which we can then compare to the "true" quadrant resulting from the MPA under the *High-definition* model (@fig-agreement). Since MPA outcomes are asymptotic as MPA size goes to 0 or 100%, we restricted this analysis to the more realistic range of 10-40% of the seascape. Focusing on the *complex* set of scenarios, the *Low-definition* model was a reliable predictor of "No Effect" outcomes, correctly diagnosing the *High-definition* state 96% of the time under the *complex scenario* set. However, the *Low-definition* model predicted the other quadrants quite poorly. *Low-definition* predictions of "Biomass Increases & Catch Increases" were correct 50% of the time. 22% of the cases in which the *Low-definition* model predicted "Biomass Increases & Catch Increases" in fact had "No Effect", followed by 25% of cases in which the true result was ""Biomass increases & Catch Decreases". *Low-definition* predictions of "Biomass increases & Catch decreases" were correct only 41% of the time, with "No Effect" being the true result in 35% of cases. While biomass decreases were possible according to the *High-definition* model, this outcome was not possible under the *Low-definition* model and as such the *Low-definition* model did not correctly diagnose any of those outcomes.

```{r}
#| label: fig-agreement
#| fig-cap: A) Percent agreement between quadrant predicted by *Low-definition* and *High-definition* model. Percent values normalized to sum to 100% for each *Low-definition* prediction bin. Red dashed diagonal line shows 1:1 line which passes through cells that indicate agreement between *Low-definition* and *High-definition* models. Grey cells indicate that the *Low-definition* model made no prediction in a given quadrant.
#| fig-height: 4

# B) Percent agreement values for a given Low-definition prediction. Percent of seascape in MPA restricted to between 10-40%. "No Effect" indicates that |percent change| is less than or equal to 5% for both biomass and catch.

# need to do this in a few confusing stages since there are multiple fleets per run
fleet_outcomes <- highres_vs_lowres |>
  filter(name != "biomass") |>
  pivot_longer(contains("percent"),
               names_to = "model",
               values_to = "percent_effect_catch")  |> 
  select(-name)

nature_outcomes <- highres_vs_lowres |>
  filter(name == "biomass") |>
  pivot_longer(contains("percent"),
               names_to = "model",
               values_to = "percent_effect_biomass") |> 
  select(state_id, placement_id, prop_mpa, critter, difficulty, model,percent_effect_biomass,-name)

compare_outcomes <- fleet_outcomes |>
  left_join(nature_outcomes,
            by = join_by(prop_mpa, placement_id, state_id, critter, difficulty, model)) |>
  mutate(
    quadrant = case_when(
      abs(percent_effect_biomass) < 0.05 &
        abs(percent_effect_catch) < 0.05 ~ "No Effect",
      percent_effect_biomass > 0 &
        percent_effect_catch > 0 ~ "Biomass Increases & Catch Increases",
      percent_effect_biomass > 0 &
        percent_effect_catch < 0 ~ "Biomass Increases & Catch Decreases",
      percent_effect_biomass < 0 &
        percent_effect_catch > 0 ~ "Biomass Decreases & Catch Increases",
      percent_effect_biomass < 0 &
        percent_effect_catch < 0 ~ "Biomass Decreases & Catch Decreases"
    )
  ) 

lowres_quadrants <- compare_outcomes |> 
  filter(str_detect(model, "lowres")) |> 
  rename(lowres_quadrant = quadrant)

highres_quadrants <- compare_outcomes |> 
  filter(!str_detect(model, "lowres")) |> 
  rename(highres_quadrant = quadrant) |> 
  select(-matches("percent|model"))

confusion_components <- lowres_quadrants |> 
  left_join(highres_quadrants) |> 
  filter(between(numeric_prop_mpa,0.01,1)) 

confusion_matrix <- confusion_components |> 
  left_join(highres_quadrants) |> 
  filter(between(numeric_prop_mpa,0.1,0.4)) |> 
  group_by(highres_quadrant, lowres_quadrant, difficulty) |>
  count() |>
  group_by(difficulty) |>
  mutate(
    highres_quadrant = factor(highres_quadrant),
    lowres_quadrant = factor(lowres_quadrant, levels = levels(highres_quadrant))
  ) |>
  complete(highres_quadrant, lowres_quadrant, fill = list(n = 0)) |>
  group_by(difficulty, lowres_quadrant) |>
  mutate(pn = n / sum(n),
         label_pn = percent(pn, accuracy = 1)) 

confusion_matrix_plot <-  confusion_matrix |>
  ggplot(aes(lowres_quadrant, highres_quadrant)) +
  geom_tile(aes(fill = pn), color = "black") +
  geom_abline(
    color = "tomato",
    slope = 1,
    intercept = 0,
    alpha = 0.5,
    linetype = 2
  ) +
  geom_text(aes(label = label_pn), size = 2) +
  facet_wrap(~ fct_rev(difficulty)) +
  scale_fill_gradient(
    low = "white",
    high = "steelblue2",
    name = "% Simulations",
    labels = scales::percent,
    limits = c(0, 1)
  ) +
  theme(axis.text.x = element_text(
    angle = 45,
    vjust = 1,
    hjust = 1
  )) +
  scale_y_discrete(name = "High-definition Reality") +
  scale_x_discrete(name = "Low-definition Prediction") + 
  labs(title = "A") + 
  guides(fill = "none")

agreement_plot <- confusion_matrix |> 
  filter(highres_quadrant == lowres_quadrant) |> 
  group_by(difficulty) |> 
  complete(lowres_quadrant, fill = list(pn = 0)) |>
  ggplot(aes(reorder(highres_quadrant, pn),pn, fill = fct_rev(difficulty))) + 
  geom_col(position = "dodge") + 
  scale_y_continuous(limits = c(0,1), labels = scales::percent, name = "% Agreement") +
  scale_x_discrete(name = "") +
  coord_flip() + 
  scale_fill_viridis_d(name = "Scenario") + 
  labs(title = "B")

fig <- confusion_matrix_plot# / agreement_plot

figsaver(fig)

```

### Drivers of Differences

The results presented here indicate that the effects of MPAs predicted by the *Low-* and *High-definition* models can be substantially different from each other, often with systemic biases in one direction or another. We used a random forest model to predict the magnitude of $\Delta$ for both catch and biomass as a function of the state variables defining the High-definition state (@fig-catch-importance, @fig-biomass-importance). *Depletion* ($B_{bau}/B_0$) was the most important predictor for both biomass and catch by a wide margin. Examining the partial dependency plots for select variables, $\Delta$ tended to increase as $B_{bau}/B_0$ decreases, meaning the lower biomass was, the more the *Low-definition* model over-estimated both biomass and catch outcomes, all else being equal. While many other variables were important predictors, none of the other variables had as clear of a partial dependency effect as *Depletion*. This does not mean that these variables do not have an effect on $\Delta$, but rather that the effects of these variables may have strong interaction effects with other variables.

```{r}
#| label: fig-catch-importance
#| fig-cap: A) Permutation-based variable importance score of included covariates on predictions of model disagreement $\Delta$ (*Low-definition* minus *High-definition*) on catch effects. B) Partial dependency plots of selected covariates. Points are permuted values, lines are partial dependency gradients for a given permutation set.

tmp <- highres_vs_lowres |>
  mutate(delta = pmax(-2, pmin(
    2, lowres_percent_mpa_effect - percent_mpa_effect
  ))) |>
  filter(name == "catch", between(numeric_prop_mpa,0.2, 0.4) )|>
  select(-matches("percent|value|id|numeric|f_v_m"),-max_cor,-min_cor,-mean_abs_cor,-mean_cor,-spawning_season,-placement_error,-step,-contains("patchiness")) |>
  mutate(random = rnorm(length(delta))) |>
  filter(is.finite(range_cor), difficulty == "complex")

tmp <- tmp[, which(map_lgl(tmp,  ~ !any(is.na(.x))))]


model_spec <-
  rand_forest(mtry = tune(),
              min_n = tune(),
              trees = tune()) %>%
  set_engine("ranger", importance = "permutation") %>%
  set_mode("regression")

model_recipe <- recipe(delta ~ ., data = tmp)

model_workflow <- 
  workflow() %>% 
  add_model(model_spec) %>% 
  add_recipe(model_recipe)

if (tune_grids | !file.exists(file.path(results_dir,"tuned_catch_grid.rds"))){

tuned_catch_grid <-
  model_workflow %>%
  tune_grid(
    resamples = vfold_cv(tmp,4),
    grid = 10,
    control = control_grid(save_pred = TRUE)
  )

write_rds(tuned_catch_grid, file.path(results_dir,"tuned_catch_grid.rds"))
} else {
  
  tuned_catch_grid <- read_rds(file.path(results_dir,"tuned_catch_grid.rds"))
  
}

best_params <- tune::select_best(tuned_catch_grid, metric = "rmse")

tuned_model_workflow <- model_workflow |> 
  finalize_workflow(best_params)

tuned_fit <- parsnip::fit(tuned_model_workflow, tmp)

catch_vip_plot <- tuned_fit %>% 
  extract_fit_parsnip() %>% 
  vip(num_features = 40) + 
  scale_y_continuous(name = "Permutation-Based Variable Importance") + 
  labs(title = "A)")


explain_fit <- DALEXtra::explain_tidymodels(tuned_fit,
                                       data = tmp, 
                              y = tmp$delta,
                                       label = "rf",
                                       colorize = TRUE,
                                       verbose = FALSE)




pdp_fit  <- model_profile(
  explain_fit,
  variables = c("depletion", "steepness", "b0", "adult_diffusion", "range_cor"),
  type = "partial",
  N = 500
)


pd_plot <- plot(
  pdp_fit,
  geom = "points",
  variables = c(
    "depletion",
    "steepness",
    "adult_diffusion",
    "range_cor"
  )
) +
  theme_minimal() +
  labs(title = "B)", subtitle = '', y = "Predicted Delta")

fig <- catch_vip_plot| pd_plot

figsaver(fig)

```

```{r}
#| label: fig-biomass-importance
#| fig-cap: A) Permutation-based variable importance score of included covariates on predictions of model disagreement (Low-definition minus High-definition) on biomass effects. B) Partial dependency plots of selected covariates. Points are permuted values, lines are partial dependency gradients for a given permutation set.

tmp <- highres_vs_lowres |>
  mutate(delta = pmax(-2, pmin(
    2, lowres_percent_mpa_effect - percent_mpa_effect
  ))) |>
  filter(name == "biomass", between(numeric_prop_mpa,0.2, 0.4) )|>
  select(-matches("percent|value|id|numeric|f_v_m"),-max_cor,-min_cor,-mean_abs_cor,-mean_cor,-spawning_season,-placement_error,-step,-contains("patchiness")) |>
  mutate(random = rnorm(length(delta))) |>
  filter(is.finite(range_cor), difficulty == "complex")

tmp <- tmp[, which(map_lgl(tmp,  ~ !any(is.na(.x))))]


model_spec <-
  rand_forest(mtry = tune(),
              min_n = tune(),
              trees = tune()) %>%
  set_engine("ranger", importance = "permutation") %>%
  set_mode("regression")

model_recipe <- recipe(delta ~ ., data = tmp)

model_workflow <- 
  workflow() %>% 
  add_model(model_spec) %>% 
  add_recipe(model_recipe)


if (tune_grids | !file.exists(file.path(results_dir,"tuned_biomass_grid.rds"))){

tuned_biomass_grid <-
  model_workflow %>%
  tune_grid(
    resamples = vfold_cv(tmp,4),
    grid = 10,
    control = control_grid(save_pred = TRUE)
  )

write_rds(tuned_biomass_grid, file.path(results_dir,"tuned_biomass_grid.rds"))
} else {
  
  tuned_biomass_grid <- read_rds(file.path(results_dir,"tuned_biomass_grid.rds"))
  
}

best_params <- tune::select_best(tuned_biomass_grid, metric = "rmse")

tuned_model_workflow <- model_workflow |> 
  finalize_workflow(best_params)

tuned_fit <- parsnip::fit(tuned_model_workflow, tmp)

biomass_vip_plot <- tuned_fit %>% 
  extract_fit_parsnip() %>% 
  vip(num_features = 40) + 
  scale_y_continuous(name = "Permutation-Based Variable Importance") + 
  labs(title = "A)")

explain_fit <- DALEXtra::explain_tidymodels(tuned_fit,
                                       data = tmp, 
                              y = tmp$delta,
                                       label = "rf",
                                       colorize = TRUE,
                                       verbose = FALSE)




pdp_fit  <- model_profile(
  explain_fit,
  variables = c("depletion", "steepness", "b0", "adult_diffusion", "range_cor"),
  type = "partial",
  N = 500
)


biomass_pd_plot <- plot(
  pdp_fit,
  geom = "points",
  variables = c(
    "depletion",
    "steepness",
    "adult_diffusion",
    "range_cor"
  )
) +
  theme_minimal() +
  labs(title = "B)", subtitle = '', y = "Predicted Delta")

fig <- biomass_vip_plot| biomass_pd_plot

figsaver(fig)

# https://htmlpreview.github.io/?https://github.com/ModelOriented/DALEX-docs/blob/master/vignettes/DALEX_parsnip.html


```

### Implications of Differences in Predictions {#sec-imps}

The results presented so far have compared the paired predictions of the *Low-definition* and *High-definition* models. As an alternative, we can use this simulation framework to evaluate the outcomes of following guidance based on the *Low-definition* model in a *High-definition* world. To achieve this, for each state we found the MPA size that maximized the total gain in catches according to the *Low-definition model*. For single species cases in the *Simple* scenarios, this is equal to the MPA size that maximizes catch for the individual species. For the *complex* scenario, this is the single MPA size that maximized catch across all four species in total. We then applied that "food maximizing" MPA size recommended by the *Low-definition* model to the *High-definition* model and compared the outcomes.

Under the *simple* scenarios, the *High-definition* model generally agreed that MPA size proposed by the *Low-definition* model would be good for both biomass and catch, though with some exceptions, and generally with lower catch benefits than predicted by the Low-definition model. However, under both the *medium* and *complex* scenarios the *Low-definition* prediction became much less reliable. In particular, MPA sizes projected to have a positive effect on catch by the *Low-definition* model frequently resulted in net reductions in catch when applied to the *High-definition* model. This difference is driven in part by the fact that the *Low-definition* model has no way of accounting for heterogeneity in habitats and fishing fleets. For example, under the *High-definition* model, protecting 30% of the seascape in an MPA may protect 30% of the habitat of one species, but near 100% of another species that primarily occurs in a small subset of the seascape. Similarly, if an MPA is placed primarily on the habitat of species *A*, but effort is then displaced onto the habitat of species *B* which is not covered by the MPA, the net result can be reduction in the population and catch of species *B* (instances in the bottom-left quadrant of @fig-imps where both biomass and catch decrease) (@fig-imps, @fig-imps2).

```{r}
#| label: fig-imps
#| fig-cap: Implications for biomass (y-axis) and catch (x-axis) of applying the catch-maximizing MPA size predicted by the *Low-definition* model to the *High-definition* model. Axes values reflect the percent change in the given value caused by the simulated MPA using the *High-definition* model. Color reflects the percent change in yield from applying the selected MPA size predicted by the *Low-definition* model. Plotted effect sizes are capped at 200%. 

catch_max_mpa_lowres <- lowres |>
  mutate(numeric_prop_mpa = as.numeric(as.character(prop_mpa))) |>
  mutate(
    delta_yield = yield_mpa - yield_bau,
    percent_delta_yield = yield_mpa / yield_bau - 1,
    delta_biomass = b_mpa - b_bau,
    percent_delta_biomass = b_mpa / b_bau - 1
  ) |>
  group_by(state_id, prop_mpa) |>
  summarise(
    total_delta_yield = sum(delta_yield),
    percent_delta_yield = total_delta_yield / sum(yield_bau),
    percent_delta_biomass = sum(b_mpa) / sum(b_bau) - 1,
    lowres_catch_prop_mpa = unique(numeric_prop_mpa)
  ) |> 
  group_by(state_id) |> 
  filter(total_delta_yield == max(total_delta_yield)) |> 
  select(-prop_mpa)

lowres_to_highres <- highres |>
  mutate(numeric_prop_mpa = as.numeric(as.character(prop_mpa))) |>
  left_join(catch_max_mpa_lowres, by = "state_id") |>
  mutate(delta_mpa = (numeric_prop_mpa - lowres_catch_prop_mpa) ^ 2) |>
  group_by(state_id, placement_strategy) |>
  filter(delta_mpa == min(delta_mpa)) |> 
  ungroup()


fleet_part <- lowres_to_highres |> 
  filter(name %in% c("catch")) |> 
  select(-tidyselect::contains("value")) |> 
  pivot_wider(names_from= name, values_from = percent_mpa_effect)

nature_part <- lowres_to_highres |> 
  filter(name %in% c("biomass")) |> 
  select(-tidyselect::contains("value"),-fleet) |> 
  pivot_wider(names_from= name, values_from = percent_mpa_effect) |> 
  select(state_id, placement_id, critter, biomass)

lowres_to_highres_outcomes <- fleet_part |> 
  left_join(nature_part, by = c("state_id", "placement_id","critter"))

fig <- lowres_to_highres_outcomes |> 
  ggplot(aes(biomass, catch, color = pmin(2,percent_delta_yield))) + 
  geom_hline(yintercept = 0, linetype = 2) + 
  geom_vline(xintercept = 0, linetype = 2) + 
  geom_point(alpha = 0.4) + 
  facet_grid(placement_strategy ~ fct_rev(difficulty)) + 
  scale_x_continuous(name = "High-definition Biomass Outcome",limits = c(-1,2), oob = squish, labels = scales::percent) + 
  scale_y_continuous(name = "High-definition Catch Outcome",limits = c(-1,2), oob = squish, labels = scales::percent) + 
  scale_color_viridis_b(option = "magma", name = "Low-definition Predicted Change in Catch", labels = scales::percent) + 
  theme(legend.position = "top")
  # scale_color_gradient2(low = "tomato", mid = "green", high = "steelblue", midpoint = 0)


figsaver(fig)

```

```{r}
#| label: fig-imps2
#| fig-cap: Difference in catch and biomass outcomes predicted by the food-maximizing MPA network predicted by the *Low-definition* model (x-axis) applied to the *High-definition world* (y-axis).  Top row is biomass effect, bottom row catch, columns indicate the scenario set in question. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA.  Plotted effect sizes are capped at 200%. 

hmm <- highres_vs_lowres |> 
  left_join(catch_max_mpa_lowres, by = "state_id") |>
  mutate(delta_mpa = (numeric_prop_mpa - lowres_catch_prop_mpa) ^ 2) |>
  group_by(state_id, placement_strategy) |>
  filter(delta_mpa == min(delta_mpa)) 

fig <- hmm |>
  ungroup() |> 
  ggplot(aes(lowres_percent_mpa_effect, percent_mpa_effect, color = depletion)) +
  geom_hline(yintercept = 0) +
  geom_vline(xintercept = 0) +
  geom_abline(slope = 1,
              intercept = 0,
              color = "tomato") +
  geom_smooth(method = "lm", color = "blue") +
  geom_point(alpha = 0.1) +
  facet_grid(name ~ fct_rev(difficulty)) +
  scale_y_continuous(
    name = "High-definition % MPA Effect",
    labels = scales::percent,
    limits = c(NA, 2),
    oob = squish
  ) +
  scale_x_continuous(
    name = "Low-definition % MPA Effect",
    labels = scales::percent,
    limits = c(NA, 2),
    oob = squish
  ) +
  scale_color_viridis_b(name = "BAU B/B0",
                        option = "mako",
                        direction = 1) +
  theme(legend.position = "top")

figsaver(fig)

```

## Discussion

<!--# Running parallel analyses is cumbersome. At best, alternative models perform equally well, meaning that the same results could have been achieved with far less work. At worst, alternative models show vastly different results, leaving open the complicated question of which to trust, if any. While difficult, these sorts of insights are important. For example, the IPCC... -->

Models are a key tool in the ecological toolbox. Recent decades have seen an explosion in computational capabilities that have vastly expanded the complexity and scale of social-ecological processes that can now be simulated, and this trend will only continue. While this expanded world of possibilities has given us the ability to take on previously impossible tasks, as the growing spatial and temporal scale of the processes being modeled make the data needed to validate these models increasingly unfeasible to collect, we can be placed in a challenging position of depending on models that cannot be confronted with data in the ways which we have relied on as a field in the past.

The science of MPAs provides a clear example of this challenge. While MPAs around the world have a vast array of policy objectives, they are increasingly being called on not only to provide protection inside their borders but to provide positive effects to population-level outcomes such as total biomass and food security [@sala2021]. However, with some clear exceptions, these population processes often occur on spatial and temporal scales that severely limit effective data collection, requiring simulation modeling.

A wide range of models have been developed to inform MPA decisions [@fulton2015]. The results of this paper show that while there are broad areas of agreement, *Low-* and *High-definition* models can provide very different predictions as to the effects of MPAs on conservation and food security outcomes, even when set to be as comparable as their internal dynamics allow.

The *Low-* and *High-definition* models agreed in some broad ways. Both models agreed that under most conditions MPAs increased biomass of protected species, and that MPAs could also increase fishery catches under the right conditions, generally when the population would have been overfished in the absence of the MPA. The predictions of the two models were also generally correlated with each other, albeit with often very high levels of bias and variation around this relationship (@fig-hi-v-low). Similarly under the *simple* set of scenarios (one species, one fleet), food maximizing MPA sizes predicted by the *Low-definition* models generally at least had positive effects on catch when applied to the *High-definition* world, though they often produced much lower catch benefits (@fig-imps2).

While there were broad areas of agreement, the MPA effects predicted by the *High-* and *Low-definition* models generally differed in meaningful ways. In terms of biomass, the *Low-definition* models over-estimated the amount that an MPA would increase biomass in nearly every simulated scenario, with the amount of positive bias generally increasing with MPA size and degree of overfishing. Under the *complex* scenarios, the median bias was roughly 100 percentage points when $B_{bau}/B_0$ was less than 0.25 (@fig-delta). The predicted catch effects between the *Low-* and *High-definition* models were also frequently extremely different, though with less bias than biomass. The *Low-definition* model tended to be positively biased for highly depleted stocks at lower MPA sizes (median roughly 25 percentage points) and negatively biased for less-depleted stocks, with increasingly negative bias as MPA size increased (@fig-delta). From the perspective of potential food-security implications, the *Low-definition* models generally substantially (by tens of percentage points) overestimated the maximum potential increase in catch it might be possible to achieve from an MPA in the *High-definition* model (@fig-max-catch). When the *Low-definition* model underestimated the catch effects generated by the *High-definition* model, it was generally because of effort displacement concentrating effort in the *High-definition* world, as opposed to rebuilding of biomass.

The *Low-definition* and *High-definition* models often made different predictions of absolute biomass and catch effects of MPAs, and their rankings also often disagreed. This is important if a *Low-definition* model was being relied on to say prioritize locations for MPA rather than making explicit predictions around specific percentage point changes in biomass or catch. The two models generally agreed that that the top-ranked fisheries in terms of potential biomass and catch benefits of MPAs were the most depleted fisheries. Beyond that though, while the rankings were correlated, the two models generally ranked individual fisheries very differently, particularly for catch (@fig-ranks). Similarly, the Low-definition model was generally a poor predictor of the "quadrant" and MPA would place a fishery in in the High-definition world (@fig-agreement). The two models almost always agreed on the "No Effect" quadrant, which generally occured from one or both of very small MPA size or very high $B_{bau}/B_0$ values. However, the Low-definition model quadrant predictions were much less accurate when at least one meaningful effect was predicted. For example, under the *complex* states, *Low-definition* predictions of a Biomass Increase & Catch Increase were correct only 50% of the time.

Interestingly, many of differences between the *Low-* and High-definition models emerged even in the *simple* set of scenarios (one species, one fleet), even in the cases where habitat of the single species is heterogeneous. This indicates that the basic dynamics of age-structure and two-dimensional space are enough on their own to explain much of the discrepancy between the *High-* and *Low-definition* models. In other words, we do not find evidence that *Low-definition* MPA models are consistently reliable emulators of *High-definition* MPA models so long as the world is "simple". Rather, even the *simple* cases had very different predictions between the two models, and these differences were only amplified for the *medium* and *complex* states.

<!--#  Many of the simulated variables were more important predictors than a random variable (@fig-catch-importance,@fig-biomass-importance). The level of depletion ($B_{bau}/B_0$) had the clearest direct effect on the degree of difference between the two models ($\Delta$), with skewed distribution that increased as $B_{bau}/B_0$ decreased, except for the edge cases where $B_{bau}/B_0$ was very close to zero. In other words, all else being equal the more depleted the species, the more the low-resolution model overestimated both biomass and catch effects of MPAs, except when $B_{bau}/B_0$ approached zero itself. This relationship between $B_{bau}/B_0$ and $\Delta$ is concerning given that more depleted species are likely to be those of primary conservation concern. While other state variables were identified as important predictors by the model, their effects appear to be a function of interaction with other variables.-->

What then are the implications of different predictions between the *Low-* and *High-definition* models? Under the *simple* world, MPA sizes designed to maximize food security under the *Low-definition* world generally at least provided $\geq$ zero benefits to biomass and catch when applied to the *High-definition* world, unless the MPAs were placed using the *avoid_fishing* placement strategy, in which cases it was possible for both biomass and catch benefits to be \< zero. However, as the states of nature became increasingly complex (four species and two fleets at most, which is still far less complex than many fisheries), the performance of the MPAs predicted to maximize food by the *Low-definition* model deteriorated, often producing net losses in catch when applied to the *High-definition* world (@fig-imps2).

From the perspective of balancing conservation and food security, the potential consequences of these results are that MPAs designed using the type of *Low-definition* model implemented here may substantially over-estimate or just misdiagnose the potential gains in catch an MPA can produce, both in terms of absolute effects and rankings, if the world in fact works in the manner stated by the *High-definition* model. From a pure conservation perspective, the potential risks of using a *Low-definition* model in a *High-definition* world are somewhat subtler. Under the *Low-definition* model it is impossible for an MPA to have a negative conservation effect, whereas negative effects are possible under the *High-definition* model, due primarily as modeled here to the combined effects of displacement of fishing effort and heterogeneous habitat. While we have no way of knowing how common the states leading to the net conservation losses predicted by the *High-definition* model are in the real world, we do have some evidence that they can occur [@abbott2012].

That being said, while there is a real risk of MPAs causing a net conservation loss, there are clearly more ways for MPAs to benefit conservation than to harm it. Why then does it matter if a *Low-definition* model tends to overestimate the conservation potential of an MPA, if the objective of an MPA is not explicitly to also benefit food security? If the goal is to rebuild a severely overfished species and a *Low-definition* model overestimates the potential conservation gains of a given MPA size, while some rebuilding may occur we may fall short of the actual rebuilding goal. There is also opportunity cost; if a manager has finite capital, real or political, to implement a conservation action, and the potential conservation benefits of an MPA are overestimated relative to an alternative policy, a sub-optimal choice may be made by the manager.

Our results show that the MPA effects predicted by *Low-* and *High-definition* models can be meaningfully different. The general framing of this paper has been to treat the *High-definition* model as "reality". This is clearly not inherently correct; just because a model is more complex does not mean it is a better representation of reality. We treat the *High-definition* model as "real" here as it is closer to the kinds of dynamics often considered to be best practices to include in stock assessments used in fisheries management [@punt2023], and as the *Low-definition* model is fit to the dynamics of the *High-definition* model. It is entirely possible though that in some cases the equations used in the *Low-definition* model may be a more parsimonious representation of reality than the *High-definition* model.

We acknowledge that the simulation exercise described here is complex and difficult to fully describe in the text of a scientific paper. To that end, all materials needed to fully reproduce all of these results are publicly available at <https://github.com/DanOvando/mpa-indicators-and-emulators>. We encourage readers seeking to better understand the nuances of the simulation settings and process to examine the code along with the text of this paper.

These results assume all data from the *High-definition* model used to fit the *Low-definition* model are perfectly measured. We also assume that all parameters (e.g. natural mortality, growth rates, habitat preferences), are time-invariant. These results also only consider the simplest of economic dynamics (constant effort with or without MPA-driven effort displacement). Other works have shown that more complex fleet dynamics can greatly affect the outcomes of spatial policies [@ovando2021; @cabral2019; @miller2016a]. Violations of these assumptions used in this paper will further complicate the ability of a model to accurately predict the effects of an MPA on conservation and catch objectives.

To add to the complexity, much of the MPA modeling literature has focused on simulating the impacts of "coastal" MPAs or more specifically MPAs focused on what is assumed to be relatively static habitats, often with relatively limited and diffusive movement. However, efforts are in development to expand the use of spatial management such as MPAs in more pelagic ecosystems, such as the international agreement on the conservation and sustainable use of marine biodiversity of areas beyond national jurisdiction [BBNJ,see @blasiak2024]. These systems are often organized around more spatio-temporally dynamic oceanographic features, and made up of often highly mobile species pursued by a complex mixture of fishing fleets representing both distant water and coastal operations. Research will be needed to consider how best to model the impacts of MPAs in the kinds of systems considered under the BBNJ agreement; @hampton2023 provides an example of the many complex variables that can affect the expected outcomes of spatial protection in pelagic systems. Further research is needed to better establish then what models are best suited for what questions in pelagic systems.

What we call a "High" definition model should really just be "Higher"; relative to an end-to-end ecosystem model the `marlin` modeling framework used in the *High-definition* model is still quite simple. A paper comparing the predictions of the `marlin` model to those of say ATLANTIS might easily show the same level of disagreement as shown here between the *High-* and *Low-definition* models. The purpose of this paper is not to establish something like `marlin` as the "correct" way to model MPAs; we instead demonstrate that the choice of model used to simulate MPA impacts can substantially affect both the magnitude and direction of predicted outcomes of closed areas.

That being said, the *High-definition* model is able to represent processes that we know exist in the real world (e.g. age structure, heterogeneous habitat, spatial fleet dynamics) and that cannot be represented in the *Low-resolution* model. We also show here that the incorporation of these processes can have substantial impacts in the projected effects of policies such as MPAs. We suggest that prior to embarking on simulation exercises practitioners should ideally develop conceptual models ["modelling what to model", @minte-vera2024] of the key processes in the system(s) they which to model, consider how these processes might impact the goals of the simulation model (e.g. projected MPA outcomes), and use this process to inform the degree of model resolution suitable for the task. A two-patch surplus production model in the manner of the *Low-resolution* model used here might be suitable in a system where one fleet targets one population distributed across a homogeneous habitat through passive diffusion. Something like the `marlin` model used in the *High-resolution* might be needed when age-structure matters, multiple species are targeted based on a range of economic incentives, and species are heterogeneously distributed in space and time. In cases where there is good reason to think that species interactions might play a strong role a more resolved ecosystem model might be needed [@audzijonyte2019], or an individual-based fleet model might be appropriate if fishing behavior is governed by highly complex policy interactions [@burgess2020a].

Conditional on an appropriately selected range of modeling choices and a clearly specified objective of the modeling exercise, how then should we go about selecting among plausible simulation options, given that statistical methods for model selection [@tredennick2021a] may not be feasible? One approach is to continue the kinds of sensitivity analyses presented here, where alternative models are compared and checked for vastly different predictions. This can at least provide some insight into which types of outcomes are sensitive to what kinds of model assumptions, and what levels of model complexity seem to at least provide consistent guidance around outcomes of interest. A preferable approach is to solve this problem by collecting more data; over time as we collect more data from across systems with MPAs before and after their implementation we may be able to fit spatially-explicit population models [@punt2019] in some systems, allowing use to empirically measure the predictive skill of competing models. However, many cases are likely to simply not have the data or capacity to estimate these kinds of models. As an alternative, we can explore the use of more easily measured traits, such as attributes of the size or age structure of the population in space and time, as indicators of the potential reliability of model-based predictions [@white2011]. For example, we might ask, are there more easily measurable indices that can serve as indicators of whether the predictions of a given model appear to be consistent with the data that can be observed?

Countries around the world are turning increasingly to spatial protection such as MPAs to achieve societal objectives, as embodied by the 30x30 movement. This means that more and more communities around the world are going to be tasked with deciding how to design MPA networks to achieve their objectives. This paper is not about the relative merits of MPAs as conservation and/or fisheries management tools; that is a much larger debate [@gaines2010; @hilborn2004a]. However, the lack of clear empirical guidance (e.g. in the form of decades of robust empirical evidence measuring the effects of large MPA networks across multiple objectives in a diverse range of settings), means that debate and design decisions around MPAs are often based on model outputs. These models could range from gut feelings, heuristics such as "protect 30%" , two-patch biomass dynamics models, models with more resolved spatial and social-ecological dynamics such as `marlin`, and all the way up to end-to-end ecosystem models such as ATLANTIS. The results presented here show that the choice of model used by a community can dramatically affect the perceived potential and optimal design of MPA networks, potentially causing inefficient MPA designs or at worst unintended negative consequences for objectives such as conservation and food security.

We have reached a point in quantitative ecology where our ability to model can far outpace our ability to monitor. The case of MPA science illustrates this challenge; while inside-vs-outside gradients can be measured relatively easily [@lester2009], broader population-level effects of MPAs on conservation and fishery outcomes can span vast areas and take years to decades to fully evolve, constraining our ability to empirically measure their outcomes [@ovando2021; @ferraro2018; @nickols2019]. We must often depend on models for MPA planning without being able to confront them with data directly. We show here that predicted effects of MPAs on conservation and food security can be highly sensitive to the choice of model used. While we do not yet have an answer for what model is suitable for what question, we suggest that practitioners using models to inform MPA science and management directly consider this challenge and provide justification for why they believe their choice of modeling framework is appropriate to the question at hand. While computational efficiency clearly plays a role, we suggest that authors should not make this the sole basis for their choice. MPAs can play an important role in the conservation and management of marine social-ecological systems, but we should acknowledge that our ability to accurately predict these effects depends largely on the suitability of modeling assumptions that may be difficult or impossible to directly test.

## References

::: {#refs}
:::

## Statements and Declarations

### Funding

The authors declare that no funds, grants, or other support were received for the preparation of this manuscript.

### Competing Interests

The authors have no relevant competing interests to disclose.

### Author Contributions

All analyses performed by Daniel Ovando. Manuscript written by Daniel Ovando.
