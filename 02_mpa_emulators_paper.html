<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Daniel Ovando">
<meta name="keywords" content="MPA, Simulation Modeling, Model Selection, Conservation Planning, Food Security">

<title>Predicted Effects of Marine Protected Areas on Conservation and Catches are Highly Sensitive to Model Structure</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="02_mpa_emulators_paper_files/libs/clipboard/clipboard.min.js"></script>
<script src="02_mpa_emulators_paper_files/libs/quarto-html/quarto.js"></script>
<script src="02_mpa_emulators_paper_files/libs/quarto-html/popper.min.js"></script>
<script src="02_mpa_emulators_paper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="02_mpa_emulators_paper_files/libs/quarto-html/anchor.min.js"></script>
<link href="02_mpa_emulators_paper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02_mpa_emulators_paper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="02_mpa_emulators_paper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="02_mpa_emulators_paper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="02_mpa_emulators_paper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#high-definition-model-and-simulations" id="toc-high-definition-model-and-simulations" class="nav-link" data-scroll-target="#high-definition-model-and-simulations">High-definition Model and Simulations</a></li>
  <li><a href="#low-definition-model" id="toc-low-definition-model" class="nav-link" data-scroll-target="#low-definition-model">Low-definition Model</a></li>
  <li><a href="#mpa-placement-scenarios" id="toc-mpa-placement-scenarios" class="nav-link" data-scroll-target="#mpa-placement-scenarios">MPA Placement Scenarios</a></li>
  <li><a href="#types-of-results" id="toc-types-of-results" class="nav-link" data-scroll-target="#types-of-results">Types of Results</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#sec-eg" id="toc-sec-eg" class="nav-link" data-scroll-target="#sec-eg">Example Trajectories</a></li>
  <li><a href="#sec-compare" id="toc-sec-compare" class="nav-link" data-scroll-target="#sec-compare">Low-definition Compared to High-definition</a></li>
  <li><a href="#drivers-of-differences" id="toc-drivers-of-differences" class="nav-link" data-scroll-target="#drivers-of-differences">Drivers of Differences</a></li>
  <li><a href="#sec-imps" id="toc-sec-imps" class="nav-link" data-scroll-target="#sec-imps">Implications of Differences in Predictions</a></li>
  </ul></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#statements-and-declarations" id="toc-statements-and-declarations" class="nav-link" data-scroll-target="#statements-and-declarations">Statements and Declarations</a>
  <ul class="collapse">
  <li><a href="#funding" id="toc-funding" class="nav-link" data-scroll-target="#funding">Funding</a></li>
  <li><a href="#competing-interests" id="toc-competing-interests" class="nav-link" data-scroll-target="#competing-interests">Competing Interests</a></li>
  <li><a href="#author-contributions" id="toc-author-contributions" class="nav-link" data-scroll-target="#author-contributions">Author Contributions</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="02_mpa_emulators_paper.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="02_mpa_emulators_paper.pdf"><i class="bi bi-file-pdf"></i>PDF (nature)</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicted Effects of Marine Protected Areas on Conservation and Catches are Highly Sensitive to Model Structure</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Daniel Ovando <a href="mailto:dovando@iattc.org" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Inter-American Tropical Tuna Commission
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>Use of Marine Protected Areas (MPAs) is expanding around the world. While MPAs can have a wide variety of objectives, scientific guidance on how to design MPAs to achieve objectives is generally based on simulation modeling. While certain questions require specific types of models, in other cases many different models may all provide an answer of some kind to a question, such as the predicted change in population biomass and fisheries catches resulting from implementation of an MPA. In these cases, the spatial and temporal scale of MPAs can prevent us from determining which model is most parsimoneous empirically, and as such the choice of model complexity can be somewhat <em>ad hoc</em>. In this paper we compare the effects of MPAs on catch and biomass predicted by a spatially explicit age-structured multi-species and multi-fleet (<em>High-definition</em>) model to the predictions generated by a two-patch surplus production (<em>Low-definition</em>) model fit to emulate the <em>High-definition</em> model. We found that while there are some areas of agreement, in many cases the predictions of the two models were markedly different, with the <em>Low-definition</em> model frequently predicting substantially higher biomass and catch benefits from MPAs than the <em>High-definition</em> model, and in many cases incorrectly estimating the direction (positive or negative) of the MPA effects. Our results show that care should be taken in selecting and interpreting the results of MPA simultion models, and that research is needed to understand what models are best suited to what policy recommendations when multiple viable options exist.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>MPA, Simulation Modeling, Model Selection, Conservation Planning, Food Security</p>
  </div>
</div>

</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The field of ecology depends on models; it is how we move from simply <em>describing</em> ecological phenomena to <em>understanding</em> ecological processes. All models are abstractions of reality though, requiring scientists to make decisions as to how best to approximate the system in question to address the ecological question at hand. In some cases, these decisions can be be based simply on first principles such as our understanding of the basic physics of the universe. In many other cases we are faced with multiple competing models of the ecological process in question, with a common goal being the search for a “parsimonious” model that best explains the phenomena in question without containing extraneous features that may reduce the performance or efficiency of the model. For example, <span class="citation" data-cites="murdoch2002">Murdoch et al. (<a href="#ref-murdoch2002" role="doc-biblioref">2002</a>)</span> examined under what conditions a single-species model may or may not be a valid representation of population dynamics of species existing in a multi-species environment.While science has employed numerous practices for judging the performance of competing models, for much of recent history we have relied largely on confronting models with data <span class="citation" data-cites="hilborn1997">(<a href="#ref-hilborn1997" role="doc-biblioref">Hilborn and Mangel 1997</a>)</span>, with the specific metric of model performance ideally determined based on the objective of the model <span class="citation" data-cites="tredennick2021a">(e.g.&nbsp;is the goal of the model data exploration, inference, or prediction, <a href="#ref-tredennick2021a" role="doc-biblioref">Tredennick et al. 2021</a>)</span>. Regardless of the method, the key feature is that models are judged by their ability to explain observed data in some way shape or form.</p>
<p>The increasing “dimensionality” of questions asked by ecology (e.g.&nbsp;number of species, spatial and temporal scales), combined with the rapid increase in computation capabilities in the last few decades has greatly expanded the use of a slightly different class of model, which can generally be called “simulation models”. The key feature of these models is that while they can perhaps be “tuned” to reality based on best available knowledge, they cannot be fit to data in a conventional statistical sense, either due to a lack of degrees of freedom (having many more parameters than available data), or an inability to measure the phenomena being simulated on a reasonable time scale.</p>
<p>These simulation models are extremely powerful, particularly as we increasingly turn to ecological sciences to help make complex policy decisions in a dynamic world. For example, the widely used Ecopath with Ecosim <span class="citation" data-cites="christensen2004">(<a href="#ref-christensen2004" role="doc-biblioref">Christensen and Walters 2004</a>)</span> modeling framework allows for complex simulation of the effects of environmental and/or policy drivers on marine ecosystems that cannot realistically be directly evaluated empirically. However, this power comes with limitations, namely in that without the ability to rely solely on first principles or statistical confrontation with data it is unclear how we should judge the performance of alternative simulation models, particularly if alternative models provide conflicting guidance as to the impact of a phenomena or policy in question.</p>
<p>This challenge is well illustrated by the science of Marine Protected Areas (MPAs). While MPAs have taken and continue to take numerous forms throughout human history <span class="citation" data-cites="johannes1978 grorud-colvert2021">(<a href="#ref-johannes1978" role="doc-biblioref">Johannes 1978</a>; <a href="#ref-grorud-colvert2021" role="doc-biblioref">Grorud-Colvert et al. 2021</a>)</span> , we refer to them here broadly as spatially defined areas in which some forms of human activities are restricted. The most conventional form of MPAs involve the restriction of some to all forms of extractive activities such as fishing without their borders. The exact form of these restrictions may vary but the choice of what is implemented is generally made to achieve some policy objective, for example protection of sensitive habitat, rebuilding of depleted fish populations, and support of food security or economic objectives.</p>
<p>The use of MPAs to achieve various policy objectives has exploded in recent years and looks to grow further, as best expressed by the goals of the 30x30 movement, which seeks to place 30% of terrestrial and marine ecosystems in some form of protected area by 2030 <span class="citation" data-cites="cbd2022">(<a href="#ref-cbd2022" role="doc-biblioref">CBD 2022</a>)</span>. While individual MPAs may differ in their specific objectives, they share a common theme that whatever the policy goal decisions must be made as to how to design a given MPA to achieve a given set of objectives, for example exactly where should the MPA be placed, how big should it be, and exactly what rules will be implemented within its borders.</p>
<p>The difficulty is that baring the most straight-forward of cases (e.g.&nbsp;protection of sensitive habitat of sessile species such as deep-water corals), determining how to design MPAs to achieve a given policy objective is almost entirely dependent on simulation models <span class="citation" data-cites="oleary2016">(<a href="#ref-oleary2016" role="doc-biblioref">O’Leary et al. 2016</a>)</span>. This is due in large part to the scale of the processes involved in determining the outcomes of a given MPA or MPA network. Many marine organisms move vast distances at one or more parts of their life cycle <span class="citation" data-cites="gerber2005">(<a href="#ref-gerber2005" role="doc-biblioref">Gerber et al. 2005</a>)</span>. The impacts of protection can take years or decades to develop <span class="citation" data-cites="nickols2019">(<a href="#ref-nickols2019" role="doc-biblioref">Nickols et al. 2019</a>)</span>. This means that empirical studies of the net effect of MPAs inside and outside of their borders can require collection data over a large spatial scale over many years, an important but costly task. Even once those data are collected, observational studies lacking appropriate statistical controls can easily misdiagnose the effects of a spatial policy such as an MPA <span class="citation" data-cites="ovando2021 ferraro2018">(<a href="#ref-ovando2021" role="doc-biblioref">Ovando et al. 2021</a>; <a href="#ref-ferraro2018" role="doc-biblioref">Ferraro, Sanchirico, and Smith 2018</a>)</span>.</p>
<p>Given then that we cannot realistically rely on experiments to design large-scale networks of MPAs, and lack the vast time series of data before and after MPAs at scale around the world to rely on observational methods, we must turn to simulation modeling to determining how to design MPAs that stand the best chance of achieving our policy objectives. A vast array of simulation models have been developed to fill this gap and help us project the potential policy impacts of MPAs <span class="citation" data-cites="fulton2015">(<a href="#ref-fulton2015" role="doc-biblioref">Fulton et al. 2015</a>)</span>. These models vary greatly in complexity, ranging from single species two-patch biomass dynamics models with analytical solutions <span class="citation" data-cites="hastings1999">(<a href="#ref-hastings1999" role="doc-biblioref">Hastings and Botsford 1999</a>)</span> to end-to-end spatially explicit social-ecological models with thousands of parameters such as ATLANTIS <span class="citation" data-cites="audzijonyte2019">(<a href="#ref-audzijonyte2019" role="doc-biblioref">Audzijonyte et al. 2019</a>)</span>.</p>
<p>Several important works have surveyed the MPA modeling landscape. <span class="citation" data-cites="gerber2003">Gerber et al. (<a href="#ref-gerber2003" role="doc-biblioref">2003</a>)</span> reviewed a range of different MPA models and summarized the types of processes included and common insights across models. <span class="citation" data-cites="pelletier2005">Pelletier and Mahévas (<a href="#ref-pelletier2005" role="doc-biblioref">2005</a>)</span> evaluated a wide range of MPA models and qualitatively scored their suitability for addressing different kinds of policy questions, but found that a very wide range of model complexities could be appropriate for broad questions like addressing “Enhancement of fisheries yield”. <span class="citation" data-cites="fulton2015">Fulton et al. (<a href="#ref-fulton2015" role="doc-biblioref">2015</a>)</span> considered the landscape of models that have been used to model MPAs, and provided recommendations on the types of models that might be appropriate for asking different questions around MPAs. While this is an extremely important contribution to the literature, the list of models categorized as appropriate for particular MPA questions can span a vast range, from single-species population dynamics models up to more end-to-end style models such as <a href="https://osmose-model.org/publications/">OSMOSE</a>. Across these works then, while it is clear that some models are more capable than others of addressing certain types of questions, conditional on being capable of addressing a question (such as the impacts of MPAs on total catch), it remains unclear to what extent the choice of a specific viable model might influence the direction and magnitude of the effect being studied.</p>
<p>The ideal case in this modelling landscape is that complexity is additive in nature, meaning that all models capture the core processes around MPAs in an unbiased manner, but some are better capable of capturing finer-scale variation in MPA outcomes related to local context. If this is the case, then we would expect the predictions of say a two-patch biomass dynamics model to be right on average over a region, providing strategic guidance as to the potential outcomes of MPAs in that area, while a more detailed model is needed provide tactical advice for the design of a specific closed area. While this additive gradient in MPA model complexity would be ideal, we are unaware of any work that has explicitly tested whether it exists. Answering this question has real policy implications, particularly because models are the primary tool used to provide advice on MPA design <span class="citation" data-cites="oleary2016 fulton2015">(<a href="#ref-oleary2016" role="doc-biblioref">O’Leary et al. 2016</a>; <a href="#ref-fulton2015" role="doc-biblioref">Fulton et al. 2015</a>)</span>. If different models along a complexity gradient do not simply provide more detailed illustrations of the same image, but rather are painting completely different pictures, the predicted effects and subsequent design of MPA networks that will increasingly affect marine ecosystems and dependent peoples may simply be an artifact of the type of model selected rather than a reflection of a robust understanding of the dynamics of these social-ecological systems.</p>
<p>To illustrate the potential consequences of diverging predictions of alternative models, consider the case of <span class="citation" data-cites="sala2021">Sala et al. (<a href="#ref-sala2021" role="doc-biblioref">2021</a>)</span>. That paper used a single species two-patch biomass dynamics modeling framework to predict the conservation and food security outcomes of a proposed global network of no-take MPAs, and as of publication of this paper is among the most highly cited and widely publicized findings in the recent marine conservation literature (<a href="https://nature.altmetric.com/details/101895056" class="uri">https://nature.altmetric.com/details/101895056</a>, noting that the outputs of this model are only one part of the broader results presented in <span class="citation" data-cites="sala2021">Sala et al. (<a href="#ref-sala2021" role="doc-biblioref">2021</a>)</span>).However, <span class="citation" data-cites="ovando2023">Ovando, Liu, et al. (<a href="#ref-ovando2023" role="doc-biblioref">2023</a>)</span> showed that minor changes to core untestable assumptions made by <span class="citation" data-cites="sala2021">Sala et al. (<a href="#ref-sala2021" role="doc-biblioref">2021</a>)</span> fundamentally altered both the total predicted outcomes of MPAs for food security and the prioritization map of this proposed global MPA network.</p>
<p>The question then is what models of MPAs are best suited for addressing which policy questions when multiple different models can in theory serve? The answer is mechanical in some cases. For example, if the goal of a given policy is to increase the mean length of a given target species, at minimum a model that tracks length is required. Conversely, if the goal of a given MPA is to rebuild the trophic structure of a fished ecosystem closer to unfished conditions, at minimum a multi-species model is needed. How though do we determine what model to use across a range of models that are all capable of tracking the same outcomes? For example, two commonly desired outcomes of MPAs are changes in total population biomass and total fishery catches. These metrics, or at least representations of them, are produced both by a two-patch biomass dynamics model and a full ecosystem model, and essentially every MPA model in between. It is unclear then how to decide which of the many models capable of simulation biomass and catch outcomes of MPAs is parsimonious for the task at hand.</p>
<p>The question of exactly what model is appropriate for what question related to spatial policies such as MPAs in marine social-ecological systems if far beyond the scope of this paper. However, this paper seeks to provide a step towards this broader goal by assessing whether models of differing complexity provide complimentary or contradictory predictions of the effects of MPAs across multiple policy dimensions. Specifically, we simulated a range of MPA outcomes using a spatially explicit age structured multi-species and multi-fleet simulation framework presented in <span class="citation" data-cites="ovando2023a">Ovando, Bradley, et al. (<a href="#ref-ovando2023a" role="doc-biblioref">2023</a>)</span> called <code>marlin</code>. We then tuned a two-patch biomass dynamics model presented in <span class="citation" data-cites="ovando2023">Ovando, Liu, et al. (<a href="#ref-ovando2023" role="doc-biblioref">2023</a>)</span> and based on <span class="citation" data-cites="cabral2020">Cabral et al. (<a href="#ref-cabral2020" role="doc-biblioref">2020</a>)</span>, the foundation for the results presented in <span class="citation" data-cites="sala2021">Sala et al. (<a href="#ref-sala2021" role="doc-biblioref">2021</a>)</span>, to emulate the simulated dynamics of the more complex <code>marlin</code> model. We compared the effects of no-take MPAs predicted by these two models, and evaluated if and when the two models were in agreement. While these are only two models out of the many available to model MPAs, they are instructive as both types of models have been used to provide predictions of the effects of MPAs on biomass and catch. We find evidence that rather than existing along a gradient of strategic to tactical, the two models provided vastly different and often contradictory predictions of the outcomes of MPAs for food security and conservation.</p>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p>This paper uses two general classes of models that we call the <em>High-</em> and <em>Low-definition</em> models. The <em>High-definition</em> model uses a framework called <code>marlin</code> described in <span class="citation" data-cites="ovando2023a">Ovando, Bradley, et al. (<a href="#ref-ovando2023a" role="doc-biblioref">2023</a>)</span> . The <code>marlin</code> model simulates arbitrary numbers of independent age-structured fish-like populations distributed in a two-dimensional seascape. These fish populations can be targeted by arbitrary numbers of fishing fleets each of which can have individual <em>métiers</em> that specify the relationship between a given fleet and a specific fish species. The <em>Low-definition</em> model is two-patch Pella-Tomlinson <span class="citation" data-cites="pella1969">(<a href="#ref-pella1969" role="doc-biblioref">Pella and Tomlinson 1969</a>)</span> surplus production model, described in <span class="citation" data-cites="ovando2023">Ovando, Liu, et al. (<a href="#ref-ovando2023" role="doc-biblioref">2023</a>)</span> and based on <span class="citation" data-cites="cabral2020">Cabral et al. (<a href="#ref-cabral2020" role="doc-biblioref">2020</a>)</span>.</p>
<p>Each simulation follows the same general structure:</p>
<ol type="1">
<li>Generate a set of state variables (e.g.&nbsp;life history parameters and fleet dynamics) from a range of <em>simple</em> (one species one fleet), <em>medium</em> (four species one fleet), and <em>complex</em> (four species two fleets) scenarios (<a href="#tbl-scenes" class="quarto-xref">Table&nbsp;1</a>)</li>
<li>Run the simulation with those state variables (<a href="#tbl-states" class="quarto-xref">Table&nbsp;2</a>) using the <em>High-definition</em> model</li>
<li>Generate data from the <em>High-definition</em> model and use it to estimate the parameters of the <em>Low-definition</em> model</li>
<li>Apply a range of MPA designs comprised of size (percent of seascape) and placement strategy for the <em>High-definition</em> case, and size only for the <em>Low-definition</em> model</li>
<li>Compare the percent change in biomass and catch predicted by the <em>High</em> and <em>Low-definition</em> models</li>
</ol>
<p>We note that this paper involves a great deal of code that cannot realistically be translated in full into the text of the methods section here. As such, the code needed to reproduce this paper and all results contained within can be accessed and run through the repository available at https://github.com/DanOvando/mpa-indicators-and-emulators.</p>
<section id="high-definition-model-and-simulations" class="level3">
<h3 class="anchored" data-anchor-id="high-definition-model-and-simulations">High-definition Model and Simulations</h3>
<p>The equations and processes describing <code>marlin</code> model used in the <em>High-definition</em> are presented in detail in <span class="citation" data-cites="ovando2023a">Ovando, Bradley, et al. (<a href="#ref-ovando2023a" role="doc-biblioref">2023</a>)</span>. Briefly, the model simulates fish populations using an age-structured population. Length-at-age is calculated using the von Bertalanffy growth equation with log-normally distributed variation in the length at age. Natural mortality at age is calculated using the length-inverse mortality function described in <span class="citation" data-cites="lorenzen2022">Lorenzen (<a href="#ref-lorenzen2022" role="doc-biblioref">2022</a>)</span>. Fecundity at age is a function of weight at age, with the potential for hyperallometric fecundity in which fecundity increases faster than weight. Recruitment follows a Beverton-Holt dynamics parameterized around steepness (<em>h</em>), with multiple options for the timing and spatial scale of density dependence (e.g.&nbsp;local vs.&nbsp;global or pre- vs.&nbsp;post-dispersal). Movement is simulated using a continuous-time Markov chain (CTMC), as described in <span class="citation" data-cites="thorson2021a">Thorson et al. (<a href="#ref-thorson2021a" role="doc-biblioref">2021</a>)</span>. This process breaks movement in a diffusion and taxis component, where the taxis component allows fish to preferentially move towards better habitat. The model runs in 6-month time steps for these simulations. Core life history values are pulled from <code>Fishlife</code> <span class="citation" data-cites="thorson2020">(<a href="#ref-thorson2020" role="doc-biblioref">Thorson 2020</a>)</span>.</p>
<p>Fishing fleets are simulated based on effort. Each fleet exerts an amount of fishing effort in a time step, and chooses how to allocate that effort in space based on a spatial-allocation strategy (e.g.&nbsp;revenue-per-unit-effort in the previous time step). Effort in a given patch applies fishing mortality to simulated species based on the <em>métier</em> in question. The <em>métier</em> specifies the contact selectivity at age of that fleet for each simulated species, the price per unit weight for each species, and the proportion of the total fishing mortality experienced by that fish species contributed by the <em>métier</em> in question. Fishing fleets can have home ports, which add a cost to fishing in a given patch that increase with linear distance from the home port.</p>
<p>Together, these fish and fleet dynamics allow <code>marlin</code> to simulate the effects of multiple fishing fleets on multiple species. For example, by simulating multiple fleets and fish species simultaneously, the model can capture bycatch dynamics in which a fleet targets one species but incidentally captures another species if it occurs in the same location as the target species.</p>
<section id="simulated-states" class="level4">
<h4 class="anchored" data-anchor-id="simulated-states">Simulated States</h4>
<p>The four possible species simulated are a grouper (<em>Epinephelus fuscoguttatus</em>, Serranidae), a shallow-reef snapper (<em>Lutjanus malabaricus</em>, Lutjanidae), a deep-reef snapper (<em>Pristipomoides filamentosus</em>, Lutjanidae), and a reef shark (<em>Carcharhinus amblyrhynchos</em>, Carcharhinidae). Two possible fleets are simulated. The parameters of each fleet, e.g.&nbsp;selectivity and price for a given species, are randomly drawn. When two fleets are simulated, fleet <span class="math inline">\(\alpha\)</span> primarily targets the grouper and shark species, fleet <span class="math inline">\(\beta\)</span> primarily targets the two snapper species, though both fleets catch all four species to some extent. The set of scenarios evaluated are shown in <a href="#tbl-scenes" class="quarto-xref">Table&nbsp;1</a>.</p>
<div id="tbl-scenes" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-scenes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Description of the three categories of simulation states evaluated.
</figcaption>
<div aria-describedby="tbl-scenes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 55%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Species</th>
<th>Fleets</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>simple</em></td>
<td><em>Snapper</em></td>
<td><span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="even">
<td><em>medium</em></td>
<td><em>Snapper, Deep-Snapper, Grouper, Shark</em></td>
<td><span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="odd">
<td><em>complex</em></td>
<td><em>Snapper, Deep-Snapper, Grouper, Shark</em></td>
<td><span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>For each scenario set we simulated 142 states. Each state was generated by drawing a random variable from the sets described in <a href="#tbl-states" class="quarto-xref">Table&nbsp;2</a>.</p>
<div id="tbl-states" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-states-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Variables that define a given simulation state. See accompanying code at https://github.com/DanOvando/mpa-indicators-and-emulators for details of individual distributions.
</figcaption>
<div aria-describedby="tbl-states-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 31%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KISS</td>
<td>Keep it Simple Stupid. When TRUE, sets habitat equal in all patches for all species</td>
</tr>
<tr class="even">
<td>MPA response</td>
<td>Dictates whether effort that used to fish inside MPAs “stays” and is redistributed or “leaves” the fishery</td>
</tr>
<tr class="odd">
<td>Habitat patchiness (<span class="math inline">\(\kappa\)</span>)</td>
<td>Low values create smooth habitat, higher values patchy habitat</td>
</tr>
<tr class="even">
<td>Max absolute correlation</td>
<td>Scales the maximum absolute correlation between species</td>
</tr>
<tr class="odd">
<td>Spatial catchability</td>
<td>Whether catchability of the fishing fleets varies in space</td>
</tr>
<tr class="even">
<td>Spatial fleet allocation</td>
<td>How the fleet distributes itself in space, one of revenue, profit per unit effort, and revenue per unit effort</td>
</tr>
<tr class="odd">
<td>Seasonal movement</td>
<td>Whether habitat flips in one half of the year to another</td>
</tr>
<tr class="even">
<td>Spawning aggregation</td>
<td>Whether spawning occurs in a concentrated location</td>
</tr>
<tr class="odd">
<td>Fishing vs.&nbsp;Natural mortality</td>
<td>Ratio of instantaneous fishing mortality rate relative to natural mortality. The higher this is, the lower <span class="math inline">\(B_{bau}/B_0\)</span> will be.</td>
</tr>
<tr class="even">
<td>Adult diffusion</td>
<td>The diffusion rate of “adult” (non-larval) fish</td>
</tr>
<tr class="odd">
<td>Larval diffusion</td>
<td>The diffusion rate of the larval fish</td>
</tr>
<tr class="even">
<td>Steepness</td>
<td>Beverton-Holt steepness value</td>
</tr>
<tr class="odd">
<td>b0</td>
<td>The unfished biomass for a given species</td>
</tr>
<tr class="even">
<td>Hyperallometry</td>
<td>Degree of hyperallometry in fecundity at age relationship</td>
</tr>
<tr class="odd">
<td>Density dependence</td>
<td>The timing of density dependence, one of “global_habitat”, “local_habitat”, “pre_dispersal”, “post_dispersal”.</td>
</tr>
<tr class="even">
<td>Ontogenetic shift</td>
<td>Whether recruitment habitat is the inverse of adult habitat</td>
</tr>
<tr class="odd">
<td>Use ports?</td>
<td>Whether or not to assign ports to individual fleets that alter cost per unit effort in patches</td>
</tr>
<tr class="even">
<td>Selectivity at age</td>
<td>Selectivity at age, set separately for every <em>métier</em></td>
</tr>
<tr class="odd">
<td>Price per unit weight</td>
<td>Price per unit weight for every <em>métier</em></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="simulating-habitats" class="level4">
<h4 class="anchored" data-anchor-id="simulating-habitats">Simulating Habitats</h4>
<p>Marine species are often distributed heterogeneously in space with various degrees of covariance among species, i.e.&nbsp;some species tend to be found together, others tend to be found apart, and those distributions can be clustered in space. We modified the methods described in <span class="citation" data-cites="thorson2017a">Thorson and Barnett (<a href="#ref-thorson2017a" role="doc-biblioref">2017</a>)</span> to automate simulation of these spatial habitat dynamics. The key parameters process is a parameter <span class="math inline">\(\kappa\)</span> that dictates the rate at which correlation among patches decrease with distance from each other. <span class="math inline">\(\kappa\)</span> is &gt;0. The closer <span class="math inline">\(\kappa\)</span> is to 0, the greater the distance at which habitat among patches are still correlated becomes. The larger <span class="math inline">\(\kappa\)</span> becomes, the less correlated habitat becomes with distance. The other parameter is a <em>c</em> by <em>c</em> matrix <strong>R</strong>, where <em>c</em> is the number of species being simulated. The upper-triangle of <strong>R</strong> is the correlation (bounded between -1 and 1) in habitat between each simulated species. A value of 1 indicates that that given pair share habitat perfectly, -1 that they share no habitat. When only one species is present, <strong>R</strong> has no effect.</p>
<p>Together then <span class="math inline">\(\kappa\)</span> dictates how “patchy” a simulated seascape is, with lower values producing a smoother habitat distribution per species, and <strong>R</strong> dictates how similar the habitats are across species. Generating random draws of <span class="math inline">\(\kappa\)</span> and <strong>R</strong> allows us to automatically generate simulations that range from essentially uniform habitats across species to cases where habitat is patchy and individual species tend to avoid each other <a href="#fig-hab" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hab" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<embed src="results/emulators_v1.0/figs/complex_state_50_habitat.pdf" class="img-fluid">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Example simulated habitat distributions. Each panel is one species, color shows the scaled number of individuals in each patch under unfished conditions.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="low-definition-model" class="level3">
<h3 class="anchored" data-anchor-id="low-definition-model">Low-definition Model</h3>
<p>Much of the early MPA modeling literature used various forms of “surplus production” models <span class="citation" data-cites="kokkalis2024">(see <a href="#ref-kokkalis2024" role="doc-biblioref">Kokkalis et al. 2024</a>)</span> often using a two-patch system in which MPAs are modeled by tracking total biomass in each patch while adjusting the relative size of patches and setting fishing mortality to zero in the MPA patch <span class="citation" data-cites="gerber2003">(<a href="#ref-gerber2003" role="doc-biblioref">Gerber et al. 2003</a>)</span>. While much more detailed models have been developed since then, these types of models are still used, particularly in cases where the goal is to simulate large number of fisheries or states <span class="citation" data-cites="sala2021">(e.g. <a href="#ref-sala2021" role="doc-biblioref">Sala et al. 2021</a>)</span>.</p>
<p>The form of two-patch surplus production model used here is the same Pella-Tomlinson structure used in <span class="citation" data-cites="costello2016">Costello et al. (<a href="#ref-costello2016" role="doc-biblioref">2016</a>)</span> although modified to allow for the kinds of two-patch MPA dynamics used in <span class="citation" data-cites="sala2021">Sala et al. (<a href="#ref-sala2021" role="doc-biblioref">2021</a>)</span>. The equations are as follows, where <em>B</em> is biomass, <em>t</em> is time, <span class="math inline">\(\phi\)</span> scales the shape of the production curve (when <span class="math inline">\(\phi\)</span> = 0.188 <span class="math inline">\(B_{MSY}/K = 0.4\)</span>), <em>g</em> is the growth rate, <em>K</em> is the carrying capacity, <em>R</em> is the proportion of the total carrying capacity inside the MPA, <span class="math inline">\(F\)</span> is the fishing mortality rate, and <em>m</em> is the movement rate:</p>
<p><span class="math inline">\(F\)</span> can be calculated with or without effort displacement. When effort displacement is turned off, total F is constant.</p>
<p><span class="math display">\[F_t = F_{BAU}\]</span></p>
<p>When effort displacement is turned on, fishing mortality outside the MPAs increases proportionally to the size of the protected area, in the same manner as <span class="citation" data-cites="sala2021">Sala et al. (<a href="#ref-sala2021" role="doc-biblioref">2021</a>)</span> .</p>
<p><span class="math display">\[F_t = 1 - (1 - F_{BAU})^{\frac{1}{1 - R}}\]</span></p>
<p>Under “local” density dependence, the population model is</p>
<p><span class="math display">\[
\begin{aligned}
B_{t+1,MPA = 1} = B_{t,MPA = 1} + \frac{\phi + 1}{\phi}gB_{t,MPA = 1} \left(1 - \left(\frac{B_{t,MPA = 1}}{K \times R}\right)^{\phi} \right) \\ - m(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA = 0}).
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
B_{t+1,MPA = 0} = (1 - F_{t}) \times ( B_{t,MPA = 0} + \frac{\phi + 1}{\phi}gB_{t,MPA = 0} \left(1 - \left(\frac{B_{t,MPA = 0}}{K \times (1 - R)}\right)^{\phi} \right) \\ +  m\left(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA= 0}\right) ).
\end{aligned}
\]</span></p>
<p>Under “pooled” density dependence, the population model is</p>
<p><span class="math display">\[B_{t,Total} = B_{t,MPA = 1} + B_{t,MPA = 0},\]</span></p>
<p><span class="math display">\[
\begin{aligned}
B_{t+1,MPA = 1} = B_{t,MPA = 1} + R \frac{\phi + 1}{\phi}gB_{t,Total} \left(1 - \left(\frac{B_{t,Total}}{K}\right)^{\phi} \right) \\ -  m\left(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA=0}\right).
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
B_{t+1,MPA = 0} = (1 - F_{t}) \times ( B_{t,MPA = 0} + (1 - R) \frac{\phi + 1}{\phi}gB_{t,Total} \left(1 - \left(\frac{B_{t,Total}}{K}\right)^{\phi} \right) \\ +  m\left(B_{t,MPA = 1} - \frac{R}{1 - R}B_{t,MPA=0}\right) ).
\end{aligned}
\]</span></p>
<p>The model uses “local” density dependence when the form of density dependence used in the High-definition model is in some way local, and “pooled” when the High-definition model density dependence is in some way global.</p>
<section id="fitting-low-definition-model" class="level4">
<h4 class="anchored" data-anchor-id="fitting-low-definition-model">Fitting Low-definition Model</h4>
<p>The Low-definition model has five core parameters: <span class="math inline">\(\phi\)</span>, <em>g</em>, <em>m</em>, <em>K</em>, and <em>D</em>, where <em>D</em> is the depletion (B/K) at the start of the simulation. Clearly all of these parameters could be made up. However, the goal of this paper is to assess the impact of model structure on simulated outcome, holding as much else constant as possible. This means that we want to find values of these parameters that allow the Low-definition model to best match the dynamics of the High-definition model.</p>
<p>To achieve these, we estimated these five parameters along with required variance parameters using the Stan programming language and the cmdstanR <span class="citation" data-cites="cmdstanr2023">(<a href="#ref-cmdstanr2023" role="doc-biblioref">Gabry et al. 2024</a>)</span> interface. For a given scenario <em>s</em> simulated by the High-definition model, we created the following experiment.</p>
<ol type="1">
<li>Fish each population from unfished biomass B0 down to a depletion of 0.1 B0, generating a vector of total biomass <strong>bdep</strong> and catch <strong>cdep</strong> over time.</li>
<li>From that depletion of 0.1 B0, move all the fish to the left-hand side of the simulated seascape, such that the right 50% of the seascape is empty of fish.</li>
<li>Close the seascape to fishing, and then let the population rebuild and disperse, create a vector of biomass in the left-hand <strong>bleft</strong> and right-hand <strong>bright</strong> side of the seascape as the population approaches B0 again and fills in the right-hand side of the seascape through adult movement and larval dispersal.</li>
<li>Pass <strong>bdep,cdep,bleft, bright</strong> to the <em>Low-definition</em> estimation model to estimate the parameters of the model.</li>
</ol>
<p>The concept here is that <strong>bdep</strong> and <strong>cdep</strong> provide information on the scale of the population (B0,unfished biomass, and the volume of catch the population can sustain), where as <strong>bleft</strong> and <strong>bright</strong> provide additional information on <em>g</em>, <span class="math inline">\(\phi\)</span>, and <em>m</em>, as the model can see how fast the population grows from a depleted state as a function of biomass, and how fast the population recolonizes the right-hand patch.</p>
<p>The structure of the model is given below, variables with <span class="math inline">\(\hat{}\)</span> indicate estimates by the model. Prior distributions were selected to be generally uninformative while providing some guidance as to the general parameter space of the variables. This model could be refined, but provides a general means for quickly and robustly fitting the data generated by the <em>High-definition</em> model.</p>
<p><span class="math display">\[
log(bdep) \sim N(log(\hat{bdep}),\sigma_b)
\]</span></p>
<p><span class="math display">\[
log(cdep) \sim N(log(\hat{cdep}),\sigma_c)
\]</span></p>
<p><span class="math display">\[
log(bright) \sim N(log(\hat{bright}),\sigma_b)
\]</span></p>
<p><span class="math display">\[
log(bleft) \sim N(log(\hat{bleft}),\sigma_b)
\]</span></p>
<p><span class="math display">\[
log(K) \sim N(10,2)
\]</span></p>
<p><span class="math display">\[
m \sim N(0.2,0.2), 0 &lt; m &lt; 1
\]</span></p>
<p><span class="math display">\[
\sigma_b \sim N(0.05,0.1), \sigma_b &gt; 0
\]</span></p>
<p><span class="math display">\[
D \sim N(0.5,0.5) ,0 &lt; D &lt; 1
\]</span></p>
<p><span class="math display">\[
log(phi) \sim N(log(0.188),0.4))
\]</span></p>
<p>The model was fit using penalized maximum likelihood through the <code>cmdstan</code> <code>optimize</code> function rather than fit using full Bayesian inference, in order to speed up computation and since we are not interested in examining uncertainty in this analysis. Models that failed to converge were discarded from the process (a very small number). We confirmed that this model was capable of recovering simulated parameters when fit to data generated by itself, and confirmed that the model was able to match the data generated by the High-definition model as well as possible given the presence of model misspecification (i.e.&nbsp;that the Low- and High-definition models have fundamentally different assumptions). Once the Low-definition parameters were estimated for a given state, the Low-definition model was then run through the appropriate MPA scenarios.</p>
</section>
</section>
<section id="mpa-placement-scenarios" class="level3">
<h3 class="anchored" data-anchor-id="mpa-placement-scenarios">MPA Placement Scenarios</h3>
<p>MPAs in this simulations are defined as fully no-take MPAs for all of the species simulated in a given iteration of the model. MPA size is defined by the proportion of the seascape placed inside the MPA. In the <em>High-definition</em> case, this is the proportion of cells in the two-dimensional space. In the <em>Low-definition</em> case, this is the patch size parameter <em>R</em>.</p>
<p>The <em>High-definition</em> case must also decide which patches will be used to achieve a given MPA size. The three possible options are:</p>
<ol type="1">
<li><em>target_fishing</em>: place MPAs in descending order of catch per patch</li>
<li><em>avoid_fishing</em>: place MPAs in ascending order of catch per patch</li>
<li><em>area</em>: start placing MPAs in bottom left corner of seascape and build up from there</li>
</ol>
<p>A given placement scenario <em>p</em> then is the intersection of the proportion of the seascape in an MPA and the strategy for placing the MPA patches.</p>
</section>
<section id="types-of-results" class="level3">
<h3 class="anchored" data-anchor-id="types-of-results">Types of Results</h3>
<p>For each simulation, both the <em>High-resolution</em> and <em>Low-resolution</em> models start at the same business-as-usual depletion level (<span class="math inline">\(B_{bau} /  B_{0}\)</span>), the biomass level that would occur in the absence of the MPA. Both resolution models are then simulated forward in time 50 years with and without the selected MPA designs. Each simulation (a combination of scenario, state and placement) produces simulated biomass per species and catch per species per fleet with and without MPAs for the <em>Low-</em> and <em>High-definition</em> models. We measured the effect sizes of the MPAs (MPAE) for state <em>s</em> and MPA placement scenario <em>p</em> for model type <em>m</em> as percentage differences in the outcome in question</p>
<p><span class="math display">\[
MPAE_{s,p,m} = \frac{Outcome_{MPA=1,s,p,m}}{Outcome_{MPA=0,s,p,m}} -1
\]</span></p>
<p>Where <em>Outcome</em> is one of catch or biomass in the water. We then calculate the percentage point difference between the two models as</p>
<p><span class="math display">\[
\Delta_{s,p} = MPAE_{s,p,m=Low} - MPAE_{s,p,m=High}
\]</span></p>
<p>Readers may be used to seeing differences in fishery outcomes measured in changes in maximum sustainable yield (MSY) based reference points such as the biomass relative to the biomass capable of producing MSY (B/BMSY) and the fishing mortality relative to the fishing mortality that would result in BMSY at equilibrium (F/FMSY). While these quantities are defined for the <em>Low-definition</em> model, they are much more complex for the <em>High-definition</em> model. This is because MSY is a function both of life history and selectivity, and under the <em>High-definition</em> models selectivity can vary both among fleets and across space. This means that the MSY-based reference points would need to be recalculated for every equilibrium fleet distribution at a given MPA size, and could potentially lead to confusing results such as B/BMSY increasing even as B decreases if changes to the fleet result in BMSY decreasing. See <span class="citation" data-cites="kapur2021">Kapur et al. (<a href="#ref-kapur2021" role="doc-biblioref">2021</a>)</span> for a discussion of these challenges. As such, we present percentage changed based summaries of results.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>The results of this analysis take the form of paired predictions of the <em>High-definition</em> and <em>Low-definition</em> models for a given combination of state <em>s</em>, placement strategy <em>p</em>, and percent of seascape in MPA (<em>pmpa</em>). For each instance. data are generated by the <em>High-definition</em> model based on the parameters of the <em>state</em>, which are then used to estimate parameters for the <em>Low-definition</em> model. Given these parameters, a range of MPA sizes are applied to the <em>High-</em> and <em>Low-definition</em> models, with placement rules for strategy <em>p</em> dictating where the MPA goes in the <em>High-definition model</em> (there is no placement option for the Low-definition model as the two-patch dynamics do not allow it).</p>
<p>Possibly the clearest and most consistent prediction from the MPA modelling literature is that more heavily fished species are more able to benefit from MPAs, both in terms of biomass and catch. Given that, in many of the results we analyze the role of fishing pressure in outcomes, expressed as <span class="math inline">\(B_{bau}/B_0\)</span> , the biomass under “business as usual” relative to unfished biomass. The lower this value, the more depleted the species in question is.</p>
<section id="sec-eg" class="level3">
<h3 class="anchored" data-anchor-id="sec-eg">Example Trajectories</h3>
<p><a href="#fig-eg-simple" class="quarto-xref">Figure&nbsp;2</a> and <a href="#fig-eg-complex" class="quarto-xref">Figure&nbsp;3</a> illustrate the kinds of outcomes produced by this simulation exercise. <a href="#fig-eg-simple" class="quarto-xref">Figure&nbsp;2</a> shows a result from the <em>simple</em> set of scenarios, in which the High-definition model has only one species and one fleet. In this case. <a href="#fig-eg-complex" class="quarto-xref">Figure&nbsp;3</a> shows a result from the <em>complex</em> set of scenarios, in which the High-definition model simulations four different species deferentially targeted by two different fishing fleets.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-eg-simple" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eg-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-eg-simple-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eg-simple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Example simulated effects of MPAs on biomass and catch under the ‘simple’ scenario (<em>High-definition</em> model only has one species and one fleet). X-axis shows the percent of the seascape protected in a no-take MPA. Y-axis shows biomass divided unfished biomass (A) or catch (B). Panel columns show MPA placement strategy used in <em>High-definition</em> model.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-eg-complex" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eg-complex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-eg-complex-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eg-complex-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Example simulated effects of MPAs on biomass and catch under the ‘complex’ scenario (<em>High-definition</em> model has four species targeted by two fleets). X-axis shows the percent of the seascape protected in a no-take MPA. Y-axis shows biomass divided unfished biomass (A) or catch (B). In <em>A</em>, color indicates species points are the <em>Low-definition</em> model and lines are the <em>High-definition</em> model. In <em>B</em>, color indicates the fleet, and each row of the panel is a separate species. Panel columns show MPA placement strategy used in <em>High-definition</em> model.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-compare" class="level3">
<h3 class="anchored" data-anchor-id="sec-compare">Low-definition Compared to High-definition</h3>
<p>Each <em>state</em>, <em>placement strategy</em> and <em>MPA size</em> is associated with predictions of percent change in biomass and catch for each species from the <em>Low-</em> and <em>High-definition</em> models (noting that fleet-specific predictions are only possible for the <em>High-definition</em> model results). Plotting the <em>Low-definition</em> versus the <em>High-definition</em> predictions provides a measure of the degree of agreement between these two models. Examining first changes in biomass, the <em>Low-definition</em> model predictions are almost universal positively biased, meaning that across nearly every simulation the <em>Low-definition</em> model predicted a higher percent increase in biomass than the <em>High-definition</em> model, often substantially so. The main area of agreement between the <em>Low-</em> and High-definition models is that the potential increases in biomass are positively correlated with the degree of fishing pressure (as measured by BAU depletion, <span class="math inline">\(B_{bau}/B_0\)</span>). Under the dynamics of the <em>Low-definition</em> model, it is impossible for an MPA to result in a net decrease in biomass, whereas this result is possible under the <em>High-definition</em> model, due in the case of this model to effort displacement from the MPA onto habitat of highly depleted species. The complexity of the simulation state had little impact on the biomass results, indicating that the basic presence of age structure and two-dimensional spatial dynamics is enough to cause this discrepancy in predicted percent changes in biomass caused by an MPA (<a href="#fig-hi-v-low" class="quarto-xref">Figure&nbsp;4</a>).</p>
<p>Examining the catch results (<a href="#fig-hi-v-low" class="quarto-xref">Figure&nbsp;4</a>), the <em>Low-definition</em> models had a relatively clear cutoff point where depletion values greater than 0.25 were less likely to provide positive catch benefits. In contrast, the <em>High-definition</em> models predicted positive catch effects across many levels of depletion. This may seem counter-intuitive, as the literature and basic biology is fairly clear that MPA can only increase catch if the population was overfished in the first place. The increased catches under higher depletion levels (lower fishing pressure) predicted by the <em>High-definition</em> model come under the <em>avoid_fishing</em> placement strategies, specifically where the fleet is concentrated in remaining fishing grounds given a constant effort fleet model and the assumption of MPA displacement rather than attrition. As with the biomass results, while there is a positive correlation between the predicted catch effects of MPAs of the <em>Low-definition</em> and <em>High-definition</em> models the relationship is quite weak and generally positively biased, meaning that the <em>Low-definition</em> model on average predicted higher increases in catch from MPAs than its paired <em>High-definition</em> model. The catch-based results are more sensitive to the complexity of the simulation, in particular the addition of a second fleet in the <em>complex</em> scenarios, than the biomass results.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hi-v-low" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hi-v-low-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-hi-v-low-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hi-v-low-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Percent change in biomass (top row) and catch (bottom row) resulting from MPAs covering between 10-40% of the simulated seascape predicted by the High-definition (x-axis) and Low-definition (y-axis) models. Panel columns correspond to the simulation set used. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA. Plotted effect sizes are capped at 200%.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We quantified the differences between the Low- and High-definition models by calculating <span class="math inline">\(\Delta\)</span> as the difference in the percentage point effect predicted by the <em>Low-</em> and <em>High-definition</em> models (<a href="#fig-delta" class="quarto-xref">Figure&nbsp;5</a>). A positive value of <span class="math inline">\(\Delta\)</span> indicates that the <em>Low-definition</em> model predicted a higher percent change in the given metric than the <em>High-definition</em> model, and <em>vice versa</em>. The <em>Low-definition</em> model consistently overestimated the percent increase in biomass caused by a given MPA across all levels of <span class="math inline">\(B_{bau}/B_0\)</span> . When <span class="math inline">\(B_{bau}/B_0\)</span> was low, the level of positive bias followed a dome-shaped pattern, peaking around median bias of roughly 150 percentage points between MPA sizes of roughly 30-60%. When <span class="math inline">\(B_{bau}/B_0\)</span> values were higher, the level of bias was lower at smaller MPA sizes but increased as MPA size increased. Higher levels of <span class="math inline">\(B_{bau}/B_0\)</span> had lower bias levels, as the models tended to agree more that the closer a population was to unfished biomass, the less scope for percentage increases in biomass is possible. Predicted catch effects were less biased than predicted biomass effects, particularly at smaller MPA sizes. The <em>Low-definition</em> model was more likely to overestimate catch effects when <span class="math inline">\(B_{bau}/B_0\)</span> was low, but across all levels of <span class="math inline">\(B_{bau}/B_0\)</span> the <em>Low-definition</em> model started to become generally negatively biased (meaning it underestimated the potential increase in catch) as MPA size increased. However, while patterns in the direction of bias exist, across all scenarios and levels of <span class="math inline">\(B_{bau}/B_0\)</span> the range of <span class="math inline">\(\Delta\)</span> values were generally extremely large, generally spanning 50 to 200 percentage points.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-delta" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-delta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-delta-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-delta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Distribution of percentage point difference (<em>Low-definition</em> minus <em>High-definition</em>) in predicted MPA effect size on biomass (top row) and catch (bottom row) (y-axis) as a function of percent of seascape in MPA (x-axis). Positive y-axis values indicates that the Low-definition predicts a more positive effect than the High-definition model, negative a more negative effect. Columns indicate simulation set used. Line is median value, bands are 50% and 90% interquantile ranges, respectively. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA. Plotted delta values sizes are capped at 200 percentage points.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Looking across the simulations, for each <em>state</em> and <em>placement strategy</em> both the <em>Low-</em> and <em>High-definition</em> models provide a prediction of the maximum percent increase in catch that could be achieved through use of MPAs. Both models broadly agree that the potential for MPAs to increase broadly proportional to the magnitude of fishing pressure without the MPA. For simulations in which the fished population was heavily depleted, the <em>Low-definition</em> model consistently predicted much greater potential increases in catch than the <em>High-definition</em> model. When the fished population was less heavily depleted, the <em>High-definition</em> model generally predicted greater potential for increased catch than the <em>Low-definition</em> model, though this was sometimes a result of increasing fishing pressure rather than rebuilding populations. In general, there was some positive correlation between the maximum predicted catch potential from the <em>Low-</em> and <em>High-definition</em> models, but the relationship was very loose <a href="#fig-max-catch" class="quarto-xref">Figure&nbsp;6</a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-max-catch" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-max-catch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-max-catch-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-max-catch-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Maximum potential percent increase in catch caused by an MPA predicted by the High-definition (y-axis) and Low-definition (x-axis) models. Facets indicate simulation set. Plotted effect sizes are capped at 200%.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Rather than comparing specific predictions of percent point changes of biomass and catch, we can also compare the “rank” of each fishery, in terms of biomass or catch potential from MPAs, predicted by the <em>Low-</em> and <em>High-definition</em> models. This can be useful if the goal of the modeling exercise is not to make explicit statements about the magnitude of changes, but simply to identify which sites might be most amenable to achieving benefits to conservation, food security, or both through MPAs. To that end we grouped simulations by MPA size and then ranked the change in biomass and catch for each simulated fishery conditional on a given MPA size. This provides a prediction of, if we were to protect a given percentage of a seascape in an MPA, which fisheries stand to benefit the most and the least (<a href="#fig-ranks" class="quarto-xref">Figure&nbsp;7</a>).</p>
<p>Both the <em>Low-</em> and <em>High-definition</em> models agreed that for both catch and biomass, the highest rank fisheries were those with the lowest <span class="math inline">\(B_{bau}/B_0\)</span> values. For the <em>simple</em> scenarios, there was near 100% agreement in the top-ranked fisheries for both biomass and catch. However, in the <em>complex</em> scenarios there was less agreement between the models even at the top ranks. Beyond the top tanks, while both models had similar trends, there was substantial variation in the specific rank predicted by the two models, particularly for catch; for the <em>complex</em> scenarios, fisheries ranked in the top 75% by the <em>Low-definition</em> models could be anywhere between near the bottom 0 or top 95% according the <em>High-definition</em> model.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ranks" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ranks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-ranks-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ranks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Percent rank of individual fisheries (intersection of fleet and species) conditional on proportion of seascape protected in a no-take MPA predicted by High-definition (x-axis) and Low-definition (y-axis). Higher percent rank indicates that an MPA is predicted to have more positive outcomes for a given fishery, lower worse outcomes. Top row shows results for biomass, bottom row shows results for catch. Columns indicate simulation set. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The objective of an MPA modeling exercise may be even coarser than rankings, simply asking which fisheries might benefit or lose in terms of biomass and catch for a given MPA size. To assess this use case, we assigned each of our simulation results to one of five quadrants:</p>
<ol type="1">
<li>Biomass increases and catch decreases</li>
<li>Biomass increases and catch increases</li>
<li>Biomass decreases and catch decreases</li>
<li>Biomass decreases and catch increases</li>
<li>No effect (neither biomass or catch changes by <span class="math inline">\(\pm\)</span> 5%)</li>
</ol>
<p>This can be viewed as a “diagnosis” problem, where the <em>Low-definition</em> model predicts the quadrant a given MPA will place a fishery in, which we can then compare to the “true” quadrant resulting from the MPA under the <em>High-definition</em> model (<a href="#fig-agreement" class="quarto-xref">Figure&nbsp;8</a>). Since MPA outcomes are asymptotic as MPA size goes to 0 or 100%, we restricted this analysis to the more realistic range of 10-40% of the seascape. Focusing on the <em>complex</em> set of scenarios, the <em>Low-definition</em> model was a reliable predictor of “No Effect” outcomes, correctly diagnosing the <em>High-definition</em> state 96% of the time under the <em>complex scenario</em> set. However, the <em>Low-definition</em> model predicted the other quadrants quite poorly. <em>Low-definition</em> predictions of “Biomass Increases &amp; Catch Increases” were correct 50% of the time. 22% of the cases in which the <em>Low-definition</em> model predicted “Biomass Increases &amp; Catch Increases” in fact had “No Effect”, followed by 25% of cases in which the true result was ““Biomass increases &amp; Catch Decreases”. <em>Low-definition</em> predictions of “Biomass increases &amp; Catch decreases” were correct only 41% of the time, with “No Effect” being the true result in 35% of cases. While biomass decreases were possible according to the <em>High-definition</em> model, this outcome was not possible under the <em>Low-definition</em> model and as such the <em>Low-definition</em> model did not correctly diagnose any of those outcomes.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-agreement" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-agreement-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-agreement-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-agreement-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: A) Percent agreement between quadrant predicted by <em>Low-definition</em> and <em>High-definition</em> model. Percent values normalized to sum to 100% for each <em>Low-definition</em> prediction bin. Red dashed diagonal line shows 1:1 line which passes through cells that indicate agreement between <em>Low-definition</em> and <em>High-definition</em> models. Grey cells indicate that the <em>Low-definition</em> model made no prediction in a given quadrant.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="drivers-of-differences" class="level3">
<h3 class="anchored" data-anchor-id="drivers-of-differences">Drivers of Differences</h3>
<p>The results presented here indicate that the effects of MPAs predicted by the <em>Low-</em> and <em>High-definition</em> models can be substantially different from each other, often with systemic biases in one direction or another. We used a random forest model to predict the magnitude of <span class="math inline">\(\Delta\)</span> for both catch and biomass as a function of the state variables defining the High-definition state (<a href="#fig-catch-importance" class="quarto-xref">Figure&nbsp;9</a>, <a href="#fig-biomass-importance" class="quarto-xref">Figure&nbsp;10</a>). <em>Depletion</em> (<span class="math inline">\(B_{bau}/B_0\)</span>) was the most important predictor for both biomass and catch by a wide margin. Examining the partial dependency plots for select variables, <span class="math inline">\(\Delta\)</span> tended to increase as <span class="math inline">\(B_{bau}/B_0\)</span> decreases, meaning the lower biomass was, the more the <em>Low-definition</em> model over-estimated both biomass and catch outcomes, all else being equal. While many other variables were important predictors, none of the other variables had as clear of a partial dependency effect as <em>Depletion</em>. This does not mean that these variables do not have an effect on <span class="math inline">\(\Delta\)</span>, but rather that the effects of these variables may have strong interaction effects with other variables.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-catch-importance" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-catch-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-catch-importance-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-catch-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: A) Permutation-based variable importance score of included covariates on predictions of model disagreement <span class="math inline">\(\Delta\)</span> (<em>Low-definition</em> minus <em>High-definition</em>) on catch effects. B) Partial dependency plots of selected covariates. Points are permuted values, lines are partial dependency gradients for a given permutation set.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-biomass-importance" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-biomass-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-biomass-importance-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-biomass-importance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: A) Permutation-based variable importance score of included covariates on predictions of model disagreement (Low-definition minus High-definition) on biomass effects. B) Partial dependency plots of selected covariates. Points are permuted values, lines are partial dependency gradients for a given permutation set.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="sec-imps" class="level3">
<h3 class="anchored" data-anchor-id="sec-imps">Implications of Differences in Predictions</h3>
<p>The results presented so far have compared the paired predictions of the <em>Low-definition</em> and <em>High-definition</em> models. As an alternative, we can use this simulation framework to evaluate the outcomes of following guidance based on the <em>Low-definition</em> model in a <em>High-definition</em> world. To achieve this, for each state we found the MPA size that maximized the total gain in catches according to the <em>Low-definition model</em>. For single species cases in the <em>Simple</em> scenarios, this is equal to the MPA size that maximizes catch for the individual species. For the <em>complex</em> scenario, this is the single MPA size that maximized catch across all four species in total. We then applied that “food maximizing” MPA size recommended by the <em>Low-definition</em> model to the <em>High-definition</em> model and compared the outcomes.</p>
<p>Under the <em>simple</em> scenarios, the <em>High-definition</em> model generally agreed that MPA size proposed by the <em>Low-definition</em> model would be good for both biomass and catch, though with some exceptions, and generally with lower catch benefits than predicted by the Low-definition model. However, under both the <em>medium</em> and <em>complex</em> scenarios the <em>Low-definition</em> prediction became much less reliable. In particular, MPA sizes projected to have a positive effect on catch by the <em>Low-definition</em> model frequently resulted in net reductions in catch when applied to the <em>High-definition</em> model. This difference is driven in part by the fact that the <em>Low-definition</em> model has no way of accounting for heterogeneity in habitats and fishing fleets. For example, under the <em>High-definition</em> model, protecting 30% of the seascape in an MPA may protect 30% of the habitat of one species, but near 100% of another species that primarily occurs in a small subset of the seascape. Similarly, if an MPA is placed primarily on the habitat of species <em>A</em>, but effort is then displaced onto the habitat of species <em>B</em> which is not covered by the MPA, the net result can be reduction in the population and catch of species <em>B</em> (instances in the bottom-left quadrant of <a href="#fig-imps" class="quarto-xref">Figure&nbsp;11</a> where both biomass and catch decrease) (<a href="#fig-imps" class="quarto-xref">Figure&nbsp;11</a>, <a href="#fig-imps2" class="quarto-xref">Figure&nbsp;12</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-imps" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-imps-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Implications for biomass (y-axis) and catch (x-axis) of applying the catch-maximizing MPA size predicted by the <em>Low-definition</em> model to the <em>High-definition</em> model. Axes values reflect the percent change in the given value caused by the simulated MPA using the <em>High-definition</em> model. Color reflects the percent change in yield from applying the selected MPA size predicted by the <em>Low-definition</em> model. Plotted effect sizes are capped at 200%.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-imps2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-imps2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02_mpa_emulators_paper_files/figure-html/fig-imps2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-imps2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Difference in catch and biomass outcomes predicted by the food-maximizing MPA network predicted by the <em>Low-definition</em> model (x-axis) applied to the <em>High-definition world</em> (y-axis). Top row is biomass effect, bottom row catch, columns indicate the scenario set in question. Color indicates the biomass divided by unfished biomass (B/B0) under business as usual (BAU) conditions without any MPA. Plotted effect sizes are capped at 200%.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<!--# Running parallel analyses is cumbersome. At best, alternative models perform equally well, meaning that the same results could have been achieved with far less work. At worst, alternative models show vastly different results, leaving open the complicated question of which to trust, if any. While difficult, these sorts of insights are important. For example, the IPCC... -->
<p>Models are a key tool in the ecological toolbox. Recent decades have seen an explosion in computational capabilities that have vastly expanded the complexity and scale of social-ecological processes that can now be simulated, and this trend will only continue. While this expanded world of possibilities has given us the ability to take on previously impossible tasks, as the growing spatial and temporal scale of the processes being modeled make the data needed to validate these models increasingly unfeasible to collect, we can be placed in a challenging position of depending on models that cannot be confronted with data in the ways which we have relied on as a field in the past.</p>
<p>The science of MPAs provides a clear example of this challenge. While MPAs around the world have a vast array of policy objectives, they are increasingly being called on not only to provide protection inside their borders but to provide positive effects to population-level outcomes such as total biomass and food security <span class="citation" data-cites="sala2021">(<a href="#ref-sala2021" role="doc-biblioref">Sala et al. 2021</a>)</span>. However, with some clear exceptions, these population processes often occur on spatial and temporal scales that severely limit effective data collection, requiring simulation modeling.</p>
<p>A wide range of models have been developed to inform MPA decisions <span class="citation" data-cites="fulton2015">(<a href="#ref-fulton2015" role="doc-biblioref">Fulton et al. 2015</a>)</span>. The results of this paper show that while there are broad areas of agreement, <em>Low-</em> and <em>High-definition</em> models can provide very different predictions as to the effects of MPAs on conservation and food security outcomes, even when set to be as comparable as their internal dynamics allow.</p>
<p>The <em>Low-</em> and <em>High-definition</em> models agreed in some broad ways. Both models agreed that under most conditions MPAs increased biomass of protected species, and that MPAs could also increase fishery catches under the right conditions, generally when the population would have been overfished in the absence of the MPA. The predictions of the two models were also generally correlated with each other, albeit with often very high levels of bias and variation around this relationship (<a href="#fig-hi-v-low" class="quarto-xref">Figure&nbsp;4</a>). Similarly under the <em>simple</em> set of scenarios (one species, one fleet), food maximizing MPA sizes predicted by the <em>Low-definition</em> models generally at least had positive effects on catch when applied to the <em>High-definition</em> world, though they often produced much lower catch benefits (<a href="#fig-imps2" class="quarto-xref">Figure&nbsp;12</a>).</p>
<p>While there were broad areas of agreement, the MPA effects predicted by the <em>High-</em> and <em>Low-definition</em> models generally differed in meaningful ways. In terms of biomass, the <em>Low-definition</em> models over-estimated the amount that an MPA would increase biomass in nearly every simulated scenario, with the amount of positive bias generally increasing with MPA size and degree of overfishing. Under the <em>complex</em> scenarios, the median bias was roughly 100 percentage points when <span class="math inline">\(B_{bau}/B_0\)</span> was less than 0.25 (<a href="#fig-delta" class="quarto-xref">Figure&nbsp;5</a>). The predicted catch effects between the <em>Low-</em> and <em>High-definition</em> models were also frequently extremely different, though with less bias than biomass. The <em>Low-definition</em> model tended to be positively biased for highly depleted stocks at lower MPA sizes (median roughly 25 percentage points) and negatively biased for less-depleted stocks, with increasingly negative bias as MPA size increased (<a href="#fig-delta" class="quarto-xref">Figure&nbsp;5</a>). From the perspective of potential food-security implications, the <em>Low-definition</em> models generally substantially (by tens of percentage points) overestimated the maximum potential increase in catch it might be possible to achieve from an MPA in the <em>High-definition</em> model (<a href="#fig-max-catch" class="quarto-xref">Figure&nbsp;6</a>). When the <em>Low-definition</em> model underestimated the catch effects generated by the <em>High-definition</em> model, it was generally because of effort displacement concentrating effort in the <em>High-definition</em> world, as opposed to rebuilding of biomass.</p>
<p>The <em>Low-definition</em> and <em>High-definition</em> models often made different predictions of absolute biomass and catch effects of MPAs, and their rankings also often disagreed. This is important if a <em>Low-definition</em> model was being relied on to say prioritize locations for MPA rather than making explicit predictions around specific percentage point changes in biomass or catch. The two models generally agreed that that the top-ranked fisheries in terms of potential biomass and catch benefits of MPAs were the most depleted fisheries. Beyond that though, while the rankings were correlated, the two models generally ranked individual fisheries very differently, particularly for catch (<a href="#fig-ranks" class="quarto-xref">Figure&nbsp;7</a>). Similarly, the Low-definition model was generally a poor predictor of the “quadrant” and MPA would place a fishery in in the High-definition world (<a href="#fig-agreement" class="quarto-xref">Figure&nbsp;8</a>). The two models almost always agreed on the “No Effect” quadrant, which generally occured from one or both of very small MPA size or very high <span class="math inline">\(B_{bau}/B_0\)</span> values. However, the Low-definition model quadrant predictions were much less accurate when at least one meaningful effect was predicted. For example, under the <em>complex</em> states, <em>Low-definition</em> predictions of a Biomass Increase &amp; Catch Increase were correct only 50% of the time.</p>
<p>Interestingly, many of differences between the <em>Low-</em> and High-definition models emerged even in the <em>simple</em> set of scenarios (one species, one fleet), even in the cases where habitat of the single species is heterogeneous. This indicates that the basic dynamics of age-structure and two-dimensional space are enough on their own to explain much of the discrepancy between the <em>High-</em> and <em>Low-definition</em> models. In other words, we do not find evidence that <em>Low-definition</em> MPA models are consistently reliable emulators of <em>High-definition</em> MPA models so long as the world is “simple”. Rather, even the <em>simple</em> cases had very different predictions between the two models, and these differences were only amplified for the <em>medium</em> and <em>complex</em> states.</p>
<!--#  Many of the simulated variables were more important predictors than a random variable (@fig-catch-importance,@fig-biomass-importance). The level of depletion ($B_{bau}/B_0$) had the clearest direct effect on the degree of difference between the two models ($\Delta$), with skewed distribution that increased as $B_{bau}/B_0$ decreased, except for the edge cases where $B_{bau}/B_0$ was very close to zero. In other words, all else being equal the more depleted the species, the more the low-resolution model overestimated both biomass and catch effects of MPAs, except when $B_{bau}/B_0$ approached zero itself. This relationship between $B_{bau}/B_0$ and $\Delta$ is concerning given that more depleted species are likely to be those of primary conservation concern. While other state variables were identified as important predictors by the model, their effects appear to be a function of interaction with other variables.-->
<p>What then are the implications of different predictions between the <em>Low-</em> and <em>High-definition</em> models? Under the <em>simple</em> world, MPA sizes designed to maximize food security under the <em>Low-definition</em> world generally at least provided <span class="math inline">\(\geq\)</span> zero benefits to biomass and catch when applied to the <em>High-definition</em> world, unless the MPAs were placed using the <em>avoid_fishing</em> placement strategy, in which cases it was possible for both biomass and catch benefits to be &lt; zero. However, as the states of nature became increasingly complex (four species and two fleets at most, which is still far less complex than many fisheries), the performance of the MPAs predicted to maximize food by the <em>Low-definition</em> model deteriorated, often producing net losses in catch when applied to the <em>High-definition</em> world (<a href="#fig-imps2" class="quarto-xref">Figure&nbsp;12</a>).</p>
<p>From the perspective of balancing conservation and food security, the potential consequences of these results are that MPAs designed using the type of <em>Low-definition</em> model implemented here may substantially over-estimate or just misdiagnose the potential gains in catch an MPA can produce, both in terms of absolute effects and rankings, if the world in fact works in the manner stated by the <em>High-definition</em> model. From a pure conservation perspective, the potential risks of using a <em>Low-definition</em> model in a <em>High-definition</em> world are somewhat subtler. Under the <em>Low-definition</em> model it is impossible for an MPA to have a negative conservation effect, whereas negative effects are possible under the <em>High-definition</em> model, due primarily as modeled here to the combined effects of displacement of fishing effort and heterogeneous habitat. While we have no way of knowing how common the states leading to the net conservation losses predicted by the <em>High-definition</em> model are in the real world, we do have some evidence that they can occur <span class="citation" data-cites="abbott2012">(<a href="#ref-abbott2012" role="doc-biblioref">Abbott and Haynie 2012</a>)</span>.</p>
<p>That being said, while there is a real risk of MPAs causing a net conservation loss, there are clearly more ways for MPAs to benefit conservation than to harm it. Why then does it matter if a <em>Low-definition</em> model tends to overestimate the conservation potential of an MPA, if the objective of an MPA is not explicitly to also benefit food security? If the goal is to rebuild a severely overfished species and a <em>Low-definition</em> model overestimates the potential conservation gains of a given MPA size, while some rebuilding may occur we may fall short of the actual rebuilding goal. There is also opportunity cost; if a manager has finite capital, real or political, to implement a conservation action, and the potential conservation benefits of an MPA are overestimated relative to an alternative policy, a sub-optimal choice may be made by the manager.</p>
<p>Our results show that the MPA effects predicted by <em>Low-</em> and <em>High-definition</em> models can be meaningfully different. The general framing of this paper has been to treat the <em>High-definition</em> model as “reality”. This is clearly not inherently correct; just because a model is more complex does not mean it is a better representation of reality. We treat the <em>High-definition</em> model as “real” here as it is closer to the kinds of dynamics often considered to be best practices to include in stock assessments used in fisheries management <span class="citation" data-cites="punt2023">(<a href="#ref-punt2023" role="doc-biblioref">Punt 2023</a>)</span>, and as the <em>Low-definition</em> model is fit to the dynamics of the <em>High-definition</em> model. It is entirely possible though that in some cases the equations used in the <em>Low-definition</em> model may be a more parsimonious representation of reality than the <em>High-definition</em> model.</p>
<p>We acknowledge that the simulation exercise described here is complex and difficult to fully describe in the text of a scientific paper. To that end, all materials needed to fully reproduce all of these results are publicly available at <a href="https://github.com/DanOvando/mpa-indicators-and-emulators" class="uri">https://github.com/DanOvando/mpa-indicators-and-emulators</a>. We encourage readers seeking to better understand the nuances of the simulation settings and process to examine the code along with the text of this paper.</p>
<p>These results assume all data from the <em>High-definition</em> model used to fit the <em>Low-definition</em> model are perfectly measured. We also assume that all parameters (e.g.&nbsp;natural mortality, growth rates, habitat preferences), are time-invariant. These results also only consider the simplest of economic dynamics (constant effort with or without MPA-driven effort displacement). Other works have shown that more complex fleet dynamics can greatly affect the outcomes of spatial policies <span class="citation" data-cites="ovando2021 cabral2019 miller2016a">(<a href="#ref-ovando2021" role="doc-biblioref">Ovando et al. 2021</a>; <a href="#ref-cabral2019" role="doc-biblioref">Cabral et al. 2019</a>; <a href="#ref-miller2016a" role="doc-biblioref">Miller and Deacon 2016</a>)</span>. Violations of these assumptions used in this paper will further complicate the ability of a model to accurately predict the effects of an MPA on conservation and catch objectives.</p>
<p>To add to the complexity, much of the MPA modeling literature has focused on simulating the impacts of “coastal” MPAs or more specifically MPAs focused on what is assumed to be relatively static habitats, often with relatively limited and diffusive movement. However, efforts are in development to expand the use of spatial management such as MPAs in more pelagic ecosystems, such as the international agreement on the conservation and sustainable use of marine biodiversity of areas beyond national jurisdiction <span class="citation" data-cites="blasiak2024">(BBNJ,see <a href="#ref-blasiak2024" role="doc-biblioref">Blasiak and Jouffray 2024</a>)</span>. These systems are often organized around more spatio-temporally dynamic oceanographic features, and made up of often highly mobile species pursued by a complex mixture of fishing fleets representing both distant water and coastal operations. Research will be needed to consider how best to model the impacts of MPAs in the kinds of systems considered under the BBNJ agreement; <span class="citation" data-cites="hampton2023">Hampton et al. (<a href="#ref-hampton2023" role="doc-biblioref">2023</a>)</span> provides an example of the many complex variables that can affect the expected outcomes of spatial protection in pelagic systems. Further research is needed to better establish then what models are best suited for what questions in pelagic systems.</p>
<p>What we call a “High” definition model should really just be “Higher”; relative to an end-to-end ecosystem model the <code>marlin</code> modeling framework used in the <em>High-definition</em> model is still quite simple. A paper comparing the predictions of the <code>marlin</code> model to those of say ATLANTIS might easily show the same level of disagreement as shown here between the <em>High-</em> and <em>Low-definition</em> models. The purpose of this paper is not to establish something like <code>marlin</code> as the “correct” way to model MPAs; we instead demonstrate that the choice of model used to simulate MPA impacts can substantially affect both the magnitude and direction of predicted outcomes of closed areas.</p>
<p>That being said, the <em>High-definition</em> model is able to represent processes that we know exist in the real world (e.g.&nbsp;age structure, heterogeneous habitat, spatial fleet dynamics) and that cannot be represented in the <em>Low-resolution</em> model. We also show here that the incorporation of these processes can have substantial impacts in the projected effects of policies such as MPAs. We suggest that prior to embarking on simulation exercises practitioners should ideally develop conceptual models <span class="citation" data-cites="minte-vera2024">(“modelling what to model,” <a href="#ref-minte-vera2024" role="doc-biblioref">Minte-Vera et al. 2024</a>)</span> of the key processes in the system(s) they which to model, consider how these processes might impact the goals of the simulation model (e.g.&nbsp;projected MPA outcomes), and use this process to inform the degree of model resolution suitable for the task. A two-patch surplus production model in the manner of the <em>Low-resolution</em> model used here might be suitable in a system where one fleet targets one population distributed across a homogeneous habitat through passive diffusion. Something like the <code>marlin</code> model used in the <em>High-resolution</em> might be needed when age-structure matters, multiple species are targeted based on a range of economic incentives, and species are heterogeneously distributed in space and time. In cases where there is good reason to think that species interactions might play a strong role a more resolved ecosystem model might be needed <span class="citation" data-cites="audzijonyte2019">(<a href="#ref-audzijonyte2019" role="doc-biblioref">Audzijonyte et al. 2019</a>)</span>, or an individual-based fleet model might be appropriate if fishing behavior is governed by highly complex policy interactions <span class="citation" data-cites="burgess2020a">(<a href="#ref-burgess2020a" role="doc-biblioref">Burgess et al. 2020</a>)</span>.</p>
<p>Conditional on an appropriately selected range of modeling choices and a clearly specified objective of the modeling exercise, how then should we go about selecting among plausible simulation options, given that statistical methods for model selection <span class="citation" data-cites="tredennick2021a">(<a href="#ref-tredennick2021a" role="doc-biblioref">Tredennick et al. 2021</a>)</span> may not be feasible? One approach is to continue the kinds of sensitivity analyses presented here, where alternative models are compared and checked for vastly different predictions. This can at least provide some insight into which types of outcomes are sensitive to what kinds of model assumptions, and what levels of model complexity seem to at least provide consistent guidance around outcomes of interest. A preferable approach is to solve this problem by collecting more data; over time as we collect more data from across systems with MPAs before and after their implementation we may be able to fit spatially-explicit population models <span class="citation" data-cites="punt2019">(<a href="#ref-punt2019" role="doc-biblioref">Punt 2019</a>)</span> in some systems, allowing use to empirically measure the predictive skill of competing models. However, many cases are likely to simply not have the data or capacity to estimate these kinds of models. As an alternative, we can explore the use of more easily measured traits, such as attributes of the size or age structure of the population in space and time, as indicators of the potential reliability of model-based predictions <span class="citation" data-cites="white2011">(<a href="#ref-white2011" role="doc-biblioref">White et al. 2011</a>)</span>. For example, we might ask, are there more easily measurable indices that can serve as indicators of whether the predictions of a given model appear to be consistent with the data that can be observed?</p>
<p>Countries around the world are turning increasingly to spatial protection such as MPAs to achieve societal objectives, as embodied by the 30x30 movement. This means that more and more communities around the world are going to be tasked with deciding how to design MPA networks to achieve their objectives. This paper is not about the relative merits of MPAs as conservation and/or fisheries management tools; that is a much larger debate <span class="citation" data-cites="gaines2010 hilborn2004a">(<a href="#ref-gaines2010" role="doc-biblioref">Gaines et al. 2010</a>; <a href="#ref-hilborn2004a" role="doc-biblioref">Hilborn et al. 2004</a>)</span>. However, the lack of clear empirical guidance (e.g.&nbsp;in the form of decades of robust empirical evidence measuring the effects of large MPA networks across multiple objectives in a diverse range of settings), means that debate and design decisions around MPAs are often based on model outputs. These models could range from gut feelings, heuristics such as “protect 30%” , two-patch biomass dynamics models, models with more resolved spatial and social-ecological dynamics such as <code>marlin</code>, and all the way up to end-to-end ecosystem models such as ATLANTIS. The results presented here show that the choice of model used by a community can dramatically affect the perceived potential and optimal design of MPA networks, potentially causing inefficient MPA designs or at worst unintended negative consequences for objectives such as conservation and food security.</p>
<p>We have reached a point in quantitative ecology where our ability to model can far outpace our ability to monitor. The case of MPA science illustrates this challenge; while inside-vs-outside gradients can be measured relatively easily <span class="citation" data-cites="lester2009">(<a href="#ref-lester2009" role="doc-biblioref">Lester et al. 2009</a>)</span>, broader population-level effects of MPAs on conservation and fishery outcomes can span vast areas and take years to decades to fully evolve, constraining our ability to empirically measure their outcomes <span class="citation" data-cites="ovando2021 ferraro2018 nickols2019">(<a href="#ref-ovando2021" role="doc-biblioref">Ovando et al. 2021</a>; <a href="#ref-ferraro2018" role="doc-biblioref">Ferraro, Sanchirico, and Smith 2018</a>; <a href="#ref-nickols2019" role="doc-biblioref">Nickols et al. 2019</a>)</span>. We must often depend on models for MPA planning without being able to confront them with data directly. We show here that predicted effects of MPAs on conservation and food security can be highly sensitive to the choice of model used. While we do not yet have an answer for what model is suitable for what question, we suggest that practitioners using models to inform MPA science and management directly consider this challenge and provide justification for why they believe their choice of modeling framework is appropriate to the question at hand. While computational efficiency clearly plays a role, we suggest that authors should not make this the sole basis for their choice. MPAs can play an important role in the conservation and management of marine social-ecological systems, but we should acknowledge that our ability to accurately predict these effects depends largely on the suitability of modeling assumptions that may be difficult or impossible to directly test.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-abbott2012" class="csl-entry" role="listitem">
Abbott, Joshua K., and Alan C. Haynie. 2012. <span>“What Are We Protecting? Fisher Behavior and the Unintended Consequences of Spatial Closures as a Fishery Management Tool.”</span> <em>Ecological Applications</em> 22 (3): 762–77. <a href="https://doi.org/10.1890/11-1319.1">https://doi.org/10.1890/11-1319.1</a>.
</div>
<div id="ref-audzijonyte2019" class="csl-entry" role="listitem">
Audzijonyte, Asta, Heidi Pethybridge, Javier Porobic, Rebecca Gorton, Isaac Kaplan, and Elizabeth A. Fulton. 2019. <span>“Atlantis: A Spatially Explicit End-to-End Marine Ecosystem Model with Dynamically Integrated Physics, Ecology and Socio-Economic Modules.”</span> <em>Methods in Ecology and Evolution</em> 10 (10): 1814–19. <a href="https://doi.org/10.1111/2041-210X.13272">https://doi.org/10.1111/2041-210X.13272</a>.
</div>
<div id="ref-blasiak2024" class="csl-entry" role="listitem">
Blasiak, Robert, and Jean-Baptiste Jouffray. 2024. <span>“When Will the BBNJ Agreement Deliver Results?”</span> <em>Npj Ocean Sustainability</em> 3 (1): 1–3. <a href="https://doi.org/10.1038/s44183-024-00058-6">https://doi.org/10.1038/s44183-024-00058-6</a>.
</div>
<div id="ref-burgess2020a" class="csl-entry" role="listitem">
Burgess, Matthew G., Ernesto Carrella, Michael Drexler, Robert L. Axtell, Richard M. Bailey, James R. Watson, Reniel B. Cabral, et al. 2020. <span>“Opportunities for Agent-Based Modelling in Human Dimensions of Fisheries.”</span> <em>Fish and Fisheries</em> 21 (3): 570–87. <a href="https://doi.org/10.1111/faf.12447">https://doi.org/10.1111/faf.12447</a>.
</div>
<div id="ref-cabral2020" class="csl-entry" role="listitem">
Cabral, Reniel B., Darcy Bradley, Juan Mayorga, Whitney Goodell, Alan M. Friedlander, Enric Sala, Christopher Costello, and Steven D. Gaines. 2020. <span>“A Global Network of Marine Protected Areas for Food.”</span> <em>Proceedings of the National Academy of Sciences</em> 117 (45): 28134–39. <a href="https://doi.org/10.1073/pnas.2000174117">https://doi.org/10.1073/pnas.2000174117</a>.
</div>
<div id="ref-cabral2019" class="csl-entry" role="listitem">
Cabral, Reniel B., Benjamin S. Halpern, Sarah E. Lester, Crow White, Steven D. Gaines, and Christopher Costello. 2019. <span>“Designing MPAs for Food Security in Open-Access Fisheries.”</span> <em>Scientific Reports</em> 9 (1): 8033. <a href="https://doi.org/10.1038/s41598-019-44406-w">https://doi.org/10.1038/s41598-019-44406-w</a>.
</div>
<div id="ref-cbd2022" class="csl-entry" role="listitem">
CBD. 2022. <span>“Decision Adopted by the Conference of the Parties to the Convention on Biological Diversity.”</span>
</div>
<div id="ref-christensen2004" class="csl-entry" role="listitem">
Christensen, Villy, and Carl J Walters. 2004. <span>“Ecopath with Ecosim: Methods, Capabilities and Limitations.”</span> <em>Ecological Modelling</em> 172 (2<span></span>4): 109–39. <a href="https://doi.org/10.1016/j.ecolmodel.2003.09.003">https://doi.org/10.1016/j.ecolmodel.2003.09.003</a>.
</div>
<div id="ref-costello2016" class="csl-entry" role="listitem">
Costello, Christopher, Daniel Ovando, Tyler Clavelle, C. Kent Strauss, Ray Hilborn, Michael C. Melnychuk, Trevor A. Branch, et al. 2016. <span>“Global Fishery Prospects Under Contrasting Management Regimes.”</span> <em>Proceedings of the National Academy of Sciences</em> 113 (18): 5125–29. <a href="https://doi.org/10.1073/pnas.1520420113">https://doi.org/10.1073/pnas.1520420113</a>.
</div>
<div id="ref-ferraro2018" class="csl-entry" role="listitem">
Ferraro, Paul J., James N. Sanchirico, and Martin D. Smith. 2018. <span>“Causal Inference in Coupled Human and Natural Systems.”</span> <em>Proceedings of the National Academy of Sciences</em>, August, 201805563. <a href="https://doi.org/10.1073/pnas.1805563115">https://doi.org/10.1073/pnas.1805563115</a>.
</div>
<div id="ref-fulton2015" class="csl-entry" role="listitem">
Fulton, Elizabeth A., Nicholas J. Bax, Rodrigo H. Bustamante, Jeffrey M. Dambacher, Catherine Dichmont, Piers K. Dunstan, Keith R. Hayes, et al. 2015. <span>“Modelling Marine Protected Areas: Insights and Hurdles.”</span> <em>Phil. Trans. R. Soc. B</em> 370 (1681): 20140278. <a href="https://doi.org/10.1098/rstb.2014.0278">https://doi.org/10.1098/rstb.2014.0278</a>.
</div>
<div id="ref-cmdstanr2023" class="csl-entry" role="listitem">
Gabry, Jonah, Rok Češnovar, Andrew Johnson, and Steve Bronder. 2024. <em>Cmdstanr: R Interface to ’CmdStan’</em>. <a href="https://mc-stan.org/cmdstanr/">https://mc-stan.org/cmdstanr/</a>.
</div>
<div id="ref-gaines2010" class="csl-entry" role="listitem">
Gaines, Steven D., Crow White, Mark H. Carr, and Stephen R. Palumbi. 2010. <span>“Designing Marine Reserve Networks for Both Conservation and Fisheries Management.”</span> <em>Proceedings of the National Academy of Sciences</em> 107 (43): 18286–93. <a href="https://doi.org/10.1073/pnas.0906473107">https://doi.org/10.1073/pnas.0906473107</a>.
</div>
<div id="ref-gerber2003" class="csl-entry" role="listitem">
Gerber, Leah R, Louis W. Botsford, Alan Hastings, Hugh P. Possingham, Steven D. Gaines, Stephen R. Palumbi, and Sandy Andelman. 2003. <span>“Population Models for Marine Reserve Design: A Retrospective and Prospective Synthesis.”</span> <em>Ecological Applications</em> 13 (sp1): 47–64. <a href="https://doi.org/10.1890/1051-0761(2003)013[0047:PMFMRD]2.0.CO;2">https://doi.org/10.1890/1051-0761(2003)013[0047:PMFMRD]2.0.CO;2</a>.
</div>
<div id="ref-gerber2005" class="csl-entry" role="listitem">
Gerber, Leah R, Selina S Heppell, Ford Ballantyne, and Enric Sala. 2005. <span>“The Role of Dispersal and Demography in Determining the Efficacy of Marine Reserves.”</span> <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 62 (4): 863–71. <a href="https://doi.org/10.1139/f05-046">https://doi.org/10.1139/f05-046</a>.
</div>
<div id="ref-grorud-colvert2021" class="csl-entry" role="listitem">
Grorud-Colvert, Kirsten, Jenna Sullivan-Stack, Callum Roberts, Vanessa Constant, Barbara Horta e Costa, Elizabeth P. Pike, Naomi Kingston, et al. 2021. <span>“The MPA Guide: A Framework to Achieve Global Goals for the Ocean.”</span> <em>Science</em> 373 (6560): eabf0861. <a href="https://doi.org/10.1126/science.abf0861">https://doi.org/10.1126/science.abf0861</a>.
</div>
<div id="ref-hampton2023" class="csl-entry" role="listitem">
Hampton, John, Patrick Lehodey, Inna Senina, Simon Nicol, Joe Scutt Phillips, and Kaon Tiamere. 2023. <span>“Limited Conservation Efficacy of Large-Scale Marine Protected Areas for Pacific Skipjack and Bigeye Tunas.”</span> <em>Frontiers in Marine Science</em> 9. <a href="https://www.frontiersin.org/articles/10.3389/fmars.2022.1060943">https://www.frontiersin.org/articles/10.3389/fmars.2022.1060943</a>.
</div>
<div id="ref-hastings1999" class="csl-entry" role="listitem">
Hastings, Alan, and Louis W. Botsford. 1999. <span>“Equivalence in Yield from Marine Reserves and Traditional Fisheries Management.”</span> <em>Science</em> 284 (5419): 1537–38. <a href="https://doi.org/10.1126/science.284.5419.1537">https://doi.org/10.1126/science.284.5419.1537</a>.
</div>
<div id="ref-hilborn1997" class="csl-entry" role="listitem">
Hilborn, Ray, and Marc Mangel. 1997. <em>The Ecological Detective: Confronting Models with Data (MPB-28)</em>. Princeton University Press. <a href="https://doi.org/10.1515/9781400847310">https://doi.org/10.1515/9781400847310</a>.
</div>
<div id="ref-hilborn2004a" class="csl-entry" role="listitem">
Hilborn, Ray, Kevin Stokes, Jean-Jacques Maguire, Tony Smith, Louis W Botsford, Marc Mangel, José Orensanz, et al. 2004. <span>“When Can Marine Reserves Improve Fisheries Management?”</span> <em>Ocean &amp; Coastal Management</em> 47 (3–4): 197–205. <a href="https://doi.org/10.1016/j.ocecoaman.2004.04.001">https://doi.org/10.1016/j.ocecoaman.2004.04.001</a>.
</div>
<div id="ref-johannes1978" class="csl-entry" role="listitem">
Johannes, R E. 1978. <span>“Traditional Marine Conservation Methods in Oceania and Their Demise.”</span> <em>Annual Review of Ecology and Systematics</em> 9 (1): 349–64. <a href="https://doi.org/10.1146/annurev.es.09.110178.002025">https://doi.org/10.1146/annurev.es.09.110178.002025</a>.
</div>
<div id="ref-kapur2021" class="csl-entry" role="listitem">
Kapur, M. S., M. C. Siple, M. Olmos, K. M. Privitera-Johnson, G. Adams, J. Best, C. Castillo-Jordán, et al. 2021. <span>“Equilibrium Reference Point Calculations for the Next Generation of Spatial Assessments.”</span> <em>Fisheries Research</em> 244 (December): 106132. <a href="https://doi.org/10.1016/j.fishres.2021.106132">https://doi.org/10.1016/j.fishres.2021.106132</a>.
</div>
<div id="ref-kokkalis2024" class="csl-entry" role="listitem">
Kokkalis, A., C. W. Berg, M. S. Kapur, H. Winker, N. S. Jacobsen, M. H. Taylor, M. Ichinokawa, et al. 2024. <span>“Good Practices for Surplus Production Models.”</span> <em>Fisheries Research</em> 275 (July): 107010. <a href="https://doi.org/10.1016/j.fishres.2024.107010">https://doi.org/10.1016/j.fishres.2024.107010</a>.
</div>
<div id="ref-lester2009" class="csl-entry" role="listitem">
Lester, S. E., B. S. Halpern, K. Grorud-Colvert, J. Lubchenco, B. I. Ruttenberg, S. D. Gaines, S. Airamé, and R. R. Warner. 2009. <span>“Biological Effects Within No-Take Marine Reserves: A Global Synthesis.”</span> <em>Marine Ecology Progress Series</em> 384: 3346.
</div>
<div id="ref-lorenzen2022" class="csl-entry" role="listitem">
Lorenzen, Kai. 2022. <span>“Size- and Age-Dependent Natural Mortality in Fish Populations: Biology, Models, Implications, and a Generalized Length-Inverse Mortality Paradigm.”</span> <em>Fisheries Research</em> 255 (November): 106454. <a href="https://doi.org/10.1016/j.fishres.2022.106454">https://doi.org/10.1016/j.fishres.2022.106454</a>.
</div>
<div id="ref-miller2016a" class="csl-entry" role="listitem">
Miller, Steve J., and Robert T. Deacon. 2016. <span>“Protecting Marine Ecosystems: Regulation Versus Market Incentives.”</span> <em>Marine Resource Economics</em> 32 (1): 83–107. <a href="https://doi.org/10.1086/689214">https://doi.org/10.1086/689214</a>.
</div>
<div id="ref-minte-vera2024" class="csl-entry" role="listitem">
Minte-Vera, Carolina V., Mark N. Maunder, Alexandre Aires-da-Silva, Haikun Xu, Juan L. Valero, Steven L. H. Teo, Patrício Barría, and Nicholas D. Ducharme-Barth. 2024. <span>“The Use of Conceptual Models to Structure Stock Assessments: A Tool for Collaboration and for <span>‘Modelling What to Model’</span>.”</span> <em>Fisheries Research</em> 279 (November): 107135. <a href="https://doi.org/10.1016/j.fishres.2024.107135">https://doi.org/10.1016/j.fishres.2024.107135</a>.
</div>
<div id="ref-murdoch2002" class="csl-entry" role="listitem">
Murdoch, W. W., B. E. Kendall, R. M. Nisbet, C. J. Briggs, E. McCauley, and R. Bolser. 2002. <span>“Single-Species Models for Many-Species Food Webs.”</span> <em>Nature</em> 417 (6888): 541–43. <a href="https://doi.org/10.1038/417541a">https://doi.org/10.1038/417541a</a>.
</div>
<div id="ref-nickols2019" class="csl-entry" role="listitem">
Nickols, Kerry J., J. Wilson White, Dan Malone, Mark H. Carr, Richard M. Starr, Marissa L. Baskett, Alan Hastings, and Louis W. Botsford. 2019. <span>“Setting Ecological Expectations for Adaptive Management of Marine Protected Areas.”</span> <em>Journal of Applied Ecology</em> 56 (10): 2376–85. https://doi.org/<a href="https://doi.org/10.1111/1365-2664.13463">https://doi.org/10.1111/1365-2664.13463</a>.
</div>
<div id="ref-oleary2016" class="csl-entry" role="listitem">
O’Leary, Bethan C., Marit Winther-Janson, John M. Bainbridge, Jemma Aitken, Julie P. Hawkins, and Callum M. Roberts. 2016. <span>“Effective Coverage Targets for Ocean Protection.”</span> <em>Conservation Letters</em> 9 (6): 398–404. https://doi.org/<a href="https://doi.org/10.1111/conl.12247">https://doi.org/10.1111/conl.12247</a>.
</div>
<div id="ref-ovando2023a" class="csl-entry" role="listitem">
Ovando, Daniel, Darcy Bradley, Echelle Burns, Lennon Thomas, and James Thorson. 2023. <span>“Simulating Benefits, Costs and Trade-Offs of Spatial Management in Marine Social-Ecological Systems.”</span> <em>Fish and Fisheries</em> n/a (n/a). <a href="https://doi.org/10.1111/faf.12804">https://doi.org/10.1111/faf.12804</a>.
</div>
<div id="ref-ovando2021" class="csl-entry" role="listitem">
Ovando, Daniel, Jennifer E. Caselle, Christopher Costello, Olivier Deschenes, Steven D. Gaines, Ray Hilborn, and Owen Liu. 2021. <span>“Assessing the Population<span>-</span>Level Conservation Effects of Marine Protected Areas.”</span> <em>Conservation Biology</em> 35 (6): 1861–70. <a href="https://doi.org/10.1111/cobi.13782">https://doi.org/10.1111/cobi.13782</a>.
</div>
<div id="ref-ovando2023" class="csl-entry" role="listitem">
Ovando, Daniel, Owen Liu, Renato Molina, Ana Parma, and Cody Szuwalski. 2023. <span>“Global Effects of Marine Protected Areas on Food Security Are Unknown.”</span> <em>Nature</em> 621 (7979): E34–36. <a href="https://doi.org/10.1038/s41586-023-06493-8">https://doi.org/10.1038/s41586-023-06493-8</a>.
</div>
<div id="ref-pella1969" class="csl-entry" role="listitem">
Pella, Jerome J., and Patrick K. Tomlinson. 1969. <span>“A Generalized Stock Production Model.”</span> <em>Inter-American Tropical Tuna Commission Bulletin</em> 13 (3): 416–97. <a href="http://aquaticcommons.org/3536/">http://aquaticcommons.org/3536/</a>.
</div>
<div id="ref-pelletier2005" class="csl-entry" role="listitem">
Pelletier, Dominique, and Stéphanie Mahévas. 2005. <span>“Spatially Explicit Fisheries Simulation Models for Policy Evaluation.”</span> <em>Fish and Fisheries</em> 6 (4): 307–49. <a href="https://doi.org/10.1111/j.1467-2979.2005.00199.x">https://doi.org/10.1111/j.1467-2979.2005.00199.x</a>.
</div>
<div id="ref-punt2019" class="csl-entry" role="listitem">
Punt, André E. 2019. <span>“Spatial Stock Assessment Methods: A Viewpoint on Current Issues and Assumptions.”</span> <em>Fisheries Research</em> 213 (May): 132–43. <a href="https://doi.org/10.1016/j.fishres.2019.01.014">https://doi.org/10.1016/j.fishres.2019.01.014</a>.
</div>
<div id="ref-punt2023" class="csl-entry" role="listitem">
———. 2023. <span>“Those Who Fail to Learn from History Are Condemned to Repeat It: A Perspective on Current Stock Assessment Good Practices and the Consequences of Not Following Them.”</span> <em>Fisheries Research</em> 261 (May): 106642. <a href="https://doi.org/10.1016/j.fishres.2023.106642">https://doi.org/10.1016/j.fishres.2023.106642</a>.
</div>
<div id="ref-sala2021" class="csl-entry" role="listitem">
Sala, Enric, Juan Mayorga, Darcy Bradley, Reniel B. Cabral, Trisha B. Atwood, Arnaud Auber, William Cheung, et al. 2021. <span>“Protecting the Global Ocean for Biodiversity, Food and Climate.”</span> <em>Nature</em>, March, 1–6. <a href="https://doi.org/10.1038/s41586-021-03371-z">https://doi.org/10.1038/s41586-021-03371-z</a>.
</div>
<div id="ref-thorson2020" class="csl-entry" role="listitem">
Thorson, James T. 2020. <span>“Predicting Recruitment Density Dependence and Intrinsic Growth Rate for All Fishes Worldwide Using a Data-Integrated Life-History Model.”</span> <em>Fish and Fisheries</em> 21 (2): 237–51. <a href="https://doi.org/10.1111/faf.12427">https://doi.org/10.1111/faf.12427</a>.
</div>
<div id="ref-thorson2021a" class="csl-entry" role="listitem">
Thorson, James T., Steven J. Barbeaux, Daniel R. Goethel, Kelly A. Kearney, Edward A. Laman, Julie K. Nielsen, Matthew R. Siskey, Kevin Siwicke, and Grant G. Thompson. 2021. <span>“Estimating Fine-Scale Movement Rates and Habitat Preferences Using Multiple Data Sources.”</span> <em>Fish and Fisheries</em> 22 (6): 1359–76. <a href="https://doi.org/10.1111/faf.12592">https://doi.org/10.1111/faf.12592</a>.
</div>
<div id="ref-thorson2017a" class="csl-entry" role="listitem">
Thorson, James T., and Lewis A. K. Barnett. 2017. <span>“Comparing Estimates of Abundance Trends and Distribution Shifts Using Single- and Multispecies Models of Fishes and Biogenic Habitat.”</span> <em>ICES Journal of Marine Science</em> 74 (5): 1311–21. <a href="https://doi.org/10.1093/icesjms/fsw193">https://doi.org/10.1093/icesjms/fsw193</a>.
</div>
<div id="ref-tredennick2021a" class="csl-entry" role="listitem">
Tredennick, Andrew T., Giles Hooker, Stephen P. Ellner, and Peter B. Adler. 2021. <span>“A Practical Guide to Selecting Models for Exploration, Inference, and Prediction in Ecology.”</span> <em>Ecology</em> 102 (6): e03336. <a href="https://doi.org/10.1002/ecy.3336">https://doi.org/10.1002/ecy.3336</a>.
</div>
<div id="ref-white2011" class="csl-entry" role="listitem">
White, J. Wilson, Louis W. Botsford, Marissa L. Baskett, Lewis AK Barnett, R. Jeffrey Barr, and Alan Hastings. 2011. <span>“Linking Models with Monitoring Data for Assessing Performance of No-Take Marine Reserves.”</span> <em>Frontiers in Ecology and the Environment</em> 9 (7): 390–99. <a href="https://doi.org/10.1890/100138">https://doi.org/10.1890/100138</a>.
</div>
</div>
</section>
<section id="statements-and-declarations" class="level2">
<h2 class="anchored" data-anchor-id="statements-and-declarations">Statements and Declarations</h2>
<section id="funding" class="level3">
<h3 class="anchored" data-anchor-id="funding">Funding</h3>
<p>The authors declare that no funds, grants, or other support were received for the preparation of this manuscript.</p>
</section>
<section id="competing-interests" class="level3">
<h3 class="anchored" data-anchor-id="competing-interests">Competing Interests</h3>
<p>The authors have no relevant competing interests to disclose.</p>
</section>
<section id="author-contributions" class="level3">
<h3 class="anchored" data-anchor-id="author-contributions">Author Contributions</h3>
<p>All analyses performed by Daniel Ovando. Manuscript written by Daniel Ovando.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>